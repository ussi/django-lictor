jsPlumbUtil={isArray:function(b){return Object.prototype.toString.call(b)==="[object Array]"},isString:function(a){return typeof a==="string"},isBoolean:function(a){return typeof a==="boolean"},isObject:function(a){return Object.prototype.toString.call(a)==="[object Object]"},merge:function(e,d){var k=jsPlumb.extend({},e);for(var h in d){if(k[h]==null||this.isString(d[h])||this.isBoolean(d[h])){k[h]=d[h]}else{if(this.isArray(d[h])&&this.isArray(k[h])){var f=[];f.push.apply(f,k[h]);f.push.apply(f,d[h]);k[h]=f}else{if(this.isObject(k[h])&&this.isObject(d[h])){for(var g in d[h]){k[h][g]=d[h][g]}}}}}return k},convertStyle:function(b,a){if("transparent"===b){return b}var g=b,f=function(h){return h.length==1?"0"+h:h},c=function(h){return f(Number(h).toString(16))},d=/(rgb[a]?\()(.*)(\))/;if(b.match(d)){var e=b.match(d)[2].split(",");g="#"+c(e[0])+c(e[1])+c(e[2]);if(!a&&e.length==4){g=g+c(e[3])}}return g},gradient:function(b,a){b=jsPlumbUtil.isArray(b)?b:[b.x,b.y];a=jsPlumbUtil.isArray(a)?a:[a.x,a.y];return(a[1]-b[1])/(a[0]-b[0])},normal:function(b,a){return -1/jsPlumbUtil.gradient(b,a)},lineLength:function(b,a){b=jsPlumbUtil.isArray(b)?b:[b.x,b.y];a=jsPlumbUtil.isArray(a)?a:[a.x,a.y];return Math.sqrt(Math.pow(a[1]-b[1],2)+Math.pow(a[0]-b[0],2))},segment:function(b,a){b=jsPlumbUtil.isArray(b)?b:[b.x,b.y];a=jsPlumbUtil.isArray(a)?a:[a.x,a.y];if(a[0]>b[0]){return(a[1]>b[1])?2:1}else{return(a[1]>b[1])?3:4}},intersects:function(f,e){var c=f.x,a=f.x+f.w,k=f.y,h=f.y+f.h,d=e.x,b=e.x+e.w,i=e.y,g=e.y+e.h;return((c<=d&&d<=a)&&(k<=i&&i<=h))||((c<=b&&b<=a)&&(k<=i&&i<=h))||((c<=d&&d<=a)&&(k<=g&&g<=h))||((c<=b&&d<=a)&&(k<=g&&g<=h))||((d<=c&&c<=b)&&(i<=k&&k<=g))||((d<=a&&a<=b)&&(i<=k&&k<=g))||((d<=c&&c<=b)&&(i<=h&&h<=g))||((d<=a&&c<=b)&&(i<=h&&h<=g))},segmentMultipliers:[null,[1,-1],[1,1],[-1,1],[-1,-1]],inverseSegmentMultipliers:[null,[-1,-1],[-1,1],[1,1],[1,-1]],pointOnLine:function(a,e,b){var d=jsPlumbUtil.gradient(a,e),i=jsPlumbUtil.segment(a,e),h=b>0?jsPlumbUtil.segmentMultipliers[i]:jsPlumbUtil.inverseSegmentMultipliers[i],c=Math.atan(d),f=Math.abs(b*Math.sin(c))*h[1],g=Math.abs(b*Math.cos(c))*h[0];return{x:a.x+g,y:a.y+f}},perpendicularLineTo:function(c,d,e){var b=jsPlumbUtil.gradient(c,d),f=Math.atan(-1/b),g=e/2*Math.sin(f),a=e/2*Math.cos(f);return[{x:d.x+a,y:d.y+g},{x:d.x-a,y:d.y-g}]},findWithFunction:function(b,d){if(b){for(var c=0;c<b.length;c++){if(d(b[c])){return c}}}return -1},indexOf:function(a,b){return jsPlumbUtil.findWithFunction(a,function(c){return c==b})},removeWithFunction:function(c,d){var b=jsPlumbUtil.findWithFunction(c,d);if(b>-1){c.splice(b,1)}return b!=-1},remove:function(b,c){var a=jsPlumbUtil.indexOf(b,c);if(a>-1){b.splice(a,1)}return a!=-1},addWithFunction:function(c,b,a){if(jsPlumbUtil.findWithFunction(c,a)==-1){c.push(b)}},addToList:function(d,b,c){var a=d[b];if(a==null){a=[],d[b]=a}a.push(c);return a},EventGenerator:function(){var c={},b=this;var a=["ready"];this.bind=function(d,e){jsPlumbUtil.addToList(c,d,e);return b};this.fire=function(g,h,d){if(c[g]){for(var f=0;f<c[g].length;f++){if(jsPlumbUtil.findWithFunction(a,function(i){return i===g})!=-1){c[g][f](h,d)}else{try{c[g][f](h,d)}catch(k){jsPlumbUtil.log("jsPlumb: fire failed for event "+g+" : "+k)}}}}return b};this.unbind=function(d){if(d){delete c[d]}else{c={}}return b};this.getListener=function(d){return c[d]}},logEnabled:true,log:function(){if(jsPlumbUtil.logEnabled&&typeof console!="undefined"){try{var b=arguments[arguments.length-1];console.log(b)}catch(a){}}},group:function(a){if(jsPlumbUtil.logEnabled&&typeof console!="undefined"){console.group(a)}},groupEnd:function(a){if(jsPlumbUtil.logEnabled&&typeof console!="undefined"){console.groupEnd(a)}},time:function(a){if(jsPlumbUtil.logEnabled&&typeof console!="undefined"){console.time(a)}},timeEnd:function(a){if(jsPlumbUtil.logEnabled&&typeof console!="undefined"){console.timeEnd(a)}}};(function(){var b=!!document.createElement("canvas").getContext,a=!!window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),d=function(){if(d.vml==undefined){var f=document.body.appendChild(document.createElement("div"));f.innerHTML='<v:shape id="vml_flag1" adj="1" />';var e=f.firstChild;e.style.behavior="url(#default#VML)";d.vml=e?typeof e.adj=="object":true;f.parentNode.removeChild(f)}return d.vml};var c=function(i){var h={},g=[],f={},e={};this.register=function(m){var l=jsPlumb.CurrentLibrary;m=l.getElementObject(m);var o=i.getId(m),k=l.getDOMElement(m);if(!h[o]){h[o]=m;g.push(m);f[o]={}}var n=function(t){if(t){var w=l.getElementObject(t),v=l.getOffset(w);for(var q=0;q<t.childNodes.length;q++){if(t.childNodes[q].nodeType!=3){var s=l.getElementObject(t.childNodes[q]),u=i.getId(s,null,true);if(u&&e[u]&&e[u]>0){var r=l.getOffset(s);f[o][u]={id:u,offset:{left:r.left-v.left,top:r.top-v.top}}}}}}};n(k)};this.endpointAdded=function(m){var r=jsPlumb.CurrentLibrary,u=document.body,k=i.getId(m),t=r.getDOMElement(m),l=t.parentNode,o=l==u;e[k]=e[k]?e[k]+1:1;while(l!=u){var q=i.getId(l);if(h[q]){var w=-1,s=r.getElementObject(l),n=r.getOffset(s);if(f[q][k]==null){var v=jsPlumb.CurrentLibrary.getOffset(m);f[q][k]={id:k,offset:{left:v.left-n.left,top:v.top-n.top}}}break}l=l.parentNode}};this.endpointDeleted=function(l){if(e[l.elementId]){e[l.elementId]--;if(e[l.elementId]<=0){for(var k in f){delete f[k][l.elementId]}}}};this.getElementsForDraggable=function(k){return f[k]};this.reset=function(){h={};g=[];f={};e={}}};if(!window.console){window.console={time:function(){},timeEnd:function(){},group:function(){},groupEnd:function(){},log:function(){}}}window.jsPlumbAdapter={headless:false,appendToRoot:function(e){document.body.appendChild(e)},getRenderModes:function(){return["canvas","svg","vml"]},isRenderModeAvailable:function(e){return{canvas:b,svg:a,vml:d()}[e]},getDragManager:function(e){return new c(e)},setRenderMode:function(i){var h;if(i){i=i.toLowerCase();var f=this.isRenderModeAvailable("canvas"),e=this.isRenderModeAvailable("svg"),g=this.isRenderModeAvailable("vml");if(i==="svg"){if(e){h="svg"}else{if(f){h="canvas"}else{if(g){h="vml"}}}}else{if(i==="canvas"&&f){h="canvas"}else{if(g){h="vml"}}}}return h}}})();(function(){var g=jsPlumbUtil.findWithFunction,G=jsPlumbUtil.indexOf,A=jsPlumbUtil.removeWithFunction,k=jsPlumbUtil.remove,r=jsPlumbUtil.addWithFunction,i=jsPlumbUtil.addToList,l=jsPlumbUtil.isArray,z=jsPlumbUtil.isString,u=jsPlumbUtil.isObject;var v=null,c=function(H,I){return n.CurrentLibrary.getAttribute(C(H),I)},d=function(I,J,H){n.CurrentLibrary.setAttribute(C(I),J,H)},y=function(I,H){n.CurrentLibrary.addClass(C(I),H)},h=function(I,H){return n.CurrentLibrary.hasClass(C(I),H)},m=function(I,H){n.CurrentLibrary.removeClass(C(I),H)},C=function(H){return n.CurrentLibrary.getElementObject(H)},s=function(H){return n.CurrentLibrary.getOffset(C(H))},a=function(H){return n.CurrentLibrary.getSize(C(H))},o=jsPlumbUtil.log,F=jsPlumbUtil.group,f=jsPlumbUtil.groupEnd,E=jsPlumbUtil.time,t=jsPlumbUtil.timeEnd,p=function(){return""+(new Date()).getTime()},B=function(aa){var U=this,ab=arguments,S=false,M=aa.parameters||{},K=U.idPrefix,X=K+(new Date()).getTime(),W=null,ac=null;U._jsPlumb=aa._jsPlumb;U.getId=function(){return X};U.tooltip=aa.tooltip;U.hoverClass=aa.hoverClass||U._jsPlumb.Defaults.HoverClass||n.Defaults.HoverClass;jsPlumbUtil.EventGenerator.apply(this);this.clone=function(){var ad=new Object();U.constructor.apply(ad,ab);return ad};this.getParameter=function(ad){return M[ad]},this.getParameters=function(){return M},this.setParameter=function(ad,ae){M[ad]=ae},this.setParameters=function(ad){M=ad},this.overlayPlacements=[];var L=aa.beforeDetach;this.isDetachAllowed=function(ad){var ae=U._jsPlumb.checkCondition("beforeDetach",ad);if(L){try{ae=L(ad)}catch(af){o("jsPlumb: beforeDetach callback failed",af)}}return ae};var O=aa.beforeDrop;this.isDropAllowed=function(ai,af,ag,ad,ae){var ah=U._jsPlumb.checkCondition("beforeDrop",{sourceId:ai,targetId:af,scope:ag,connection:ad,dropEndpoint:ae});if(O){try{ah=O({sourceId:ai,targetId:af,scope:ag,connection:ad,dropEndpoint:ae})}catch(aj){o("jsPlumb: beforeDrop callback failed",aj)}}return ah};var Y=function(){if(W&&ac){var ad={};n.extend(ad,W);n.extend(ad,ac);delete U.hoverPaintStyle;if(ad.gradient&&W.fillStyle){delete ad.gradient}ac=ad}};this.setPaintStyle=function(ad,ae){W=ad;U.paintStyleInUse=W;Y();if(!ae){U.repaint()}};this.getPaintStyle=function(){return W};this.setHoverPaintStyle=function(ad,ae){ac=ad;Y();if(!ae){U.repaint()}};this.getHoverPaintStyle=function(){return ac};this.setHover=function(ad,af,ae){if(!U._jsPlumb.currentlyDragging&&!U._jsPlumb.isHoverSuspended()){S=ad;if(U.hoverClass!=null&&U.canvas!=null){if(ad){J.addClass(U.canvas,U.hoverClass)}else{J.removeClass(U.canvas,U.hoverClass)}}if(ac!=null){U.paintStyleInUse=ad?ac:W;ae=ae||p();U.repaint({timestamp:ae,recalc:false})}if(U.getAttachedElements&&!af){Z(ad,p(),U)}}};this.isHover=function(){return S};var V=null;this.setZIndex=function(ad){V=ad};this.getZIndex=function(){return V};var J=n.CurrentLibrary,I=["click","dblclick","mouseenter","mouseout","mousemove","mousedown","mouseup","contextmenu"],T={mouseout:"mouseexit"},N=function(af,ag,ae){var ad=T[ae]||ae;J.bind(af,ae,function(ah){ag.fire(ad,ag,ah)})},R=function(af,ae){var ad=T[ae]||ae;J.unbind(af,ae)};this.attachListeners=function(ae,af){for(var ad=0;ad<I.length;ad++){N(ae,af,I[ad])}};var Z=function(ah,ag,ad){var af=U.getAttachedElements();if(af){for(var ae=0;ae<af.length;ae++){if(!ad||ad!=af[ae]){af[ae].setHover(ah,true,ag)}}}};this.reattachListenersForElement=function(ae){if(arguments.length>1){for(var ad=0;ad<I.length;ad++){R(ae,I[ad])}for(var ad=1;ad<arguments.length;ad++){U.attachListeners(ae,arguments[ad])}}};var H=[],P=function(ad){return ad==null?null:ad.split(" ")},Q=function(ae){if(U.getDefaultType){var ag=U.getTypeDescriptor();var af=jsPlumbUtil.merge({},U.getDefaultType());for(var ad=0;ad<H.length;ad++){af=jsPlumbUtil.merge(af,U._jsPlumb.getType(H[ad],ag))}U.applyType(af);if(!ae){U.repaint()}}};U.setType=function(ad,ae){H=P(ad)||[];Q(ae)};U.getType=function(){return H};U.hasType=function(ad){return jsPlumbUtil.indexOf(H,ad)!=-1};U.addType=function(af,ag){var ae=P(af),ah=false;if(ae!=null){for(var ad=0;ad<ae.length;ad++){if(!U.hasType(ae[ad])){H.push(ae[ad]);ah=true}}if(ah){Q(ag)}}};U.removeType=function(ag,ah){var ae=P(ag),ai=false,af=function(ak){var aj=jsPlumbUtil.indexOf(H,ak);if(aj!=-1){H.splice(aj,1);return true}return false};if(ae!=null){for(var ad=0;ad<ae.length;ad++){ai=af(ae[ad])||ai}if(ai){Q(ah)}}};U.toggleType=function(ag,ah){var af=P(ag);if(af!=null){for(var ae=0;ae<af.length;ae++){var ad=jsPlumbUtil.indexOf(H,af[ae]);if(ad!=-1){H.splice(ad,1)}else{H.push(af[ae])}}Q(ah)}};this.applyType=function(ae){U.setPaintStyle(ae.paintStyle);U.setHoverPaintStyle(ae.hoverPaintStyle);if(ae.parameters){for(var ad in ae.parameters){U.setParameter(ad,ae.parameters[ad])}}}},x=function(M){B.apply(this,arguments);var S=this;this.overlays=[];var K=function(X){var V=null;if(l(X)){var U=X[0],W=n.extend({component:S,_jsPlumb:S._jsPlumb},X[1]);if(X.length==3){n.extend(W,X[2])}V=new n.Overlays[S._jsPlumb.getRenderMode()][U](W);if(W.events){for(var T in W.events){V.bind(T,W.events[T])}}}else{if(X.constructor==String){V=new n.Overlays[S._jsPlumb.getRenderMode()][X]({component:S,_jsPlumb:S._jsPlumb})}else{V=X}}S.overlays.push(V)},L=function(X){var T=S.defaultOverlayKeys||[],W=X.overlays,U=function(Y){return S._jsPlumb.Defaults[Y]||n.Defaults[Y]||[]};if(!W){W=[]}for(var V=0;V<T.length;V++){W.unshift.apply(W,U(T[V]))}return W};var I=L(M);if(I){for(var O=0;O<I.length;O++){K(I[O])}}var H=function(V){var T=-1;for(var U=0;U<S.overlays.length;U++){if(V===S.overlays[U].id){T=U;break}}return T};this.addOverlay=function(T,U){K(T);if(!U){S.repaint()}};this.getOverlay=function(U){var T=H(U);return T>=0?S.overlays[T]:null};this.getOverlays=function(){return S.overlays};this.hideOverlay=function(U){var T=S.getOverlay(U);if(T){T.hide()}};this.hideOverlays=function(){for(var T=0;T<S.overlays.length;T++){S.overlays[T].hide()}};this.showOverlay=function(U){var T=S.getOverlay(U);if(T){T.show()}};this.showOverlays=function(){for(var T=0;T<S.overlays.length;T++){S.overlays[T].show()}};this.removeAllOverlays=function(){for(var T in S.overlays){S.overlays[T].cleanup()}S.overlays.splice(0,S.overlays.length);S.repaint()};this.removeOverlay=function(U){var T=H(U);if(T!=-1){var V=S.overlays[T];V.cleanup();S.overlays.splice(T,1)}};this.removeOverlays=function(){for(var T=0;T<arguments.length;T++){S.removeOverlay(arguments[T])}};var J="__label",R=function(V){var T={cssClass:V.cssClass,labelStyle:this.labelStyle,id:J,component:S,_jsPlumb:S._jsPlumb},U=n.extend(T,V);return new n.Overlays[S._jsPlumb.getRenderMode()].Label(U)};if(M.label){var P=M.labelLocation||S.defaultLabelLocation||0.5,Q=M.labelStyle||S._jsPlumb.Defaults.LabelStyle||n.Defaults.LabelStyle;this.overlays.push(R({label:M.label,location:P,labelStyle:Q}))}this.setLabel=function(T){var U=S.getOverlay(J);if(!U){var V=T.constructor==String||T.constructor==Function?{label:T}:T;U=R(V);this.overlays.push(U)}else{if(T.constructor==String||T.constructor==Function){U.setLabel(T)}else{if(T.label){U.setLabel(T.label)}if(T.location){U.setLocation(T.location)}}}if(!S._jsPlumb.isSuspendDrawing()){S.repaint()}};this.getLabel=function(){var T=S.getOverlay(J);return T!=null?T.getLabel():null};this.getLabelOverlay=function(){return S.getOverlay(J)};var N=this.applyType;this.applyType=function(U){N(U);S.removeAllOverlays();if(U.overlays){for(var T=0;T<U.overlays.length;T++){S.addOverlay(U.overlays[T],true)}}}},D=function(J,H,I){J.bind("click",function(K,L){H.fire("click",H,L)});J.bind("dblclick",function(K,L){H.fire("dblclick",H,L)});J.bind("contextmenu",function(K,L){H.fire("contextmenu",H,L)});J.bind("mouseenter",function(K,L){if(!H.isHover()){I(true);H.fire("mouseenter",H,L)}});J.bind("mouseexit",function(K,L){if(H.isHover()){I(false);H.fire("mouseexit",H,L)}})};var e=0,b=function(){var H=e+1;e++;return H};var w=function(I){this.Defaults={Anchor:"BottomCenter",Anchors:[null,null],ConnectionsDetachable:true,ConnectionOverlays:[],Connector:"Bezier",ConnectorZIndex:null,Container:null,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fillStyle:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:false,Overlays:[],MaxConnections:1,PaintStyle:{lineWidth:8,strokeStyle:"#456"},RenderMode:"svg",Scope:"jsPlumb_DefaultScope"};if(I){n.extend(this.Defaults,I)}this.logEnabled=this.Defaults.LogEnabled;var a5={},ak={};this.registerConnectionType=function(bB,bA){a5[bB]=n.extend({},bA)};this.registerConnectionTypes=function(bB){for(var bA in bB){a5[bA]=n.extend({},bB[bA])}};this.registerEndpointType=function(bB,bA){ak[bB]=n.extend({},bA)};this.registerEndpointTypes=function(bB){for(var bA in bB){ak[bA]=n.extend({},bB[bA])}};this.getType=function(bB,bA){return bA==="connection"?a5[bB]:ak[bB]};jsPlumbUtil.EventGenerator.apply(this);var br=this,aO=b(),aR=br.bind,aE={};for(var aD in this.Defaults){aE[aD]=this.Defaults[aD]}this.bind=function(bB,bA){if("ready"===bB&&K){bA()}else{aR.apply(br,[bB,bA])}};br.importDefaults=function(bB){for(var bA in bB){br.Defaults[bA]=bB[bA]}};br.restoreDefaults=function(){br.Defaults=n.extend({},aE)};var O=null,au=function(){n.repaintEverything()},bt=true,aS=function(){if(bt){au()}},bj=null,K=false,a1={},aW={},aX={},ai={},bv={},bk={},bq={},bz=[],af=[],R=this.Defaults.Scope,Y=null,W=function(bD,bB,bC){var bA=bD[bB];if(bA==null){bA=[];bD[bB]=bA}bA.push(bC);return bA},aY=function(bB,bA){if(br.Defaults.Container){n.CurrentLibrary.appendElement(bB,br.Defaults.Container)}else{if(!bA){jsPlumbAdapter.appendToRoot(bB)}else{n.CurrentLibrary.appendElement(bB,bA)}}},aF=1,am=function(){return""+aF++},aL=function(bA){return bA._nodes?bA._nodes:bA},be=function(bC,bE,bD){if(!jsPlumbAdapter.headless&&!ba){var bF=c(bC,"id"),bA=br.dragManager.getElementsForDraggable(bF);if(bD==null){bD=p()}br.anchorManager.redraw(bF,bE,bD);if(bA){for(var bB in bA){br.anchorManager.redraw(bA[bB].id,bE,bD,bA[bB].offset)}}}},aJ=function(bB,bD){var bE=null;if(l(bB)){bE=[];for(var bA=0;bA<bB.length;bA++){var bC=C(bB[bA]),bF=c(bC,"id");bE.push(bD(bC,bF))}}else{var bC=C(bB),bF=c(bC,"id");bE=bD(bC,bF)}return bE},ax=function(bA){return aX[bA]},bg=function(bE,bA,bH){if(!jsPlumbAdapter.headless){var bJ=bA==null?false:bA,bF=n.CurrentLibrary;if(bJ){if(bF.isDragSupported(bE)&&!bF.isAlreadyDraggable(bE)){var bI=bH||br.Defaults.DragOptions||n.Defaults.DragOptions;bI=n.extend({},bI);var bG=bF.dragEvents.drag,bB=bF.dragEvents.stop,bD=bF.dragEvents.start;bI[bD]=ao(bI[bD],function(){br.setHoverSuspended(true)});bI[bG]=ao(bI[bG],function(){var bK=bF.getUIPosition(arguments);be(bE,bK);y(bE,"jsPlumb_dragged")});bI[bB]=ao(bI[bB],function(){var bK=bF.getUIPosition(arguments);be(bE,bK);m(bE,"jsPlumb_dragged");br.setHoverSuspended(false)});var bC=H(bE);bq[bC]=true;var bJ=bq[bC];bI.disabled=bJ==null?false:!bJ;bF.initDraggable(bE,bI,false);br.dragManager.register(bE)}}}},aC=function(bG,bB){var bA=n.extend({},bG);if(bB){n.extend(bA,bB)}if(bA.source&&bA.source.endpoint){bA.sourceEndpoint=bA.source}if(bA.source&&bA.target.endpoint){bA.targetEndpoint=bA.target}if(bG.uuids){bA.sourceEndpoint=ax(bG.uuids[0]);bA.targetEndpoint=ax(bG.uuids[1])}if(bA.sourceEndpoint&&bA.sourceEndpoint.isFull()){o(br,"could not add connection; source endpoint is full");return}if(bA.targetEndpoint&&bA.targetEndpoint.isFull()){o(br,"could not add connection; target endpoint is full");return}if(!bA.type&&bA.sourceEndpoint){bA.type=bA.sourceEndpoint.connectionType}if(bA.sourceEndpoint&&bA.sourceEndpoint.connectorOverlays){bA.overlays=bA.overlays||[];for(var bE=0;bE<bA.sourceEndpoint.connectorOverlays.length;bE++){bA.overlays.push(bA.sourceEndpoint.connectorOverlays[bE])}}bA.tooltip=bG.tooltip;if(!bA.tooltip&&bA.sourceEndpoint&&bA.sourceEndpoint.connectorTooltip){bA.tooltip=bA.sourceEndpoint.connectorTooltip}if(bA.target&&!bA.target.endpoint&&!bA.targetEndpoint&&!bA.newConnection){var bF=H(bA.target),bH=a2[bF],bC=aK[bF];if(bH){if(!al[bF]){return}var bD=bC!=null?bC:br.addEndpoint(bA.target,bH);if(bl[bF]){aK[bF]=bD}bA.targetEndpoint=bD;bD._makeTargetCreator=true}}if(bA.source&&!bA.source.endpoint&&!bA.sourceEndpoint&&!bA.newConnection){var bF=H(bA.source),bH=aB[bF],bC=a7[bF];if(bH){if(!ad[bF]){return}var bD=bC!=null?bC:br.addEndpoint(bA.source,bH);if(bd[bF]){a7[bF]=bD}bA.sourceEndpoint=bD}}return bA},ae=function(bE){var bD=br.Defaults.ConnectionType||br.getDefaultConnectionType(),bC=br.Defaults.EndpointType||ag,bB=n.CurrentLibrary.getParent;if(bE.container){bE.parent=bE.container}else{if(bE.sourceEndpoint){bE.parent=bE.sourceEndpoint.parent}else{if(bE.source.constructor==bC){bE.parent=bE.source.parent}else{bE.parent=bB(bE.source)}}}bE._jsPlumb=br;var bA=new bD(bE);bA.id="con_"+am();bx("click","click",bA);bx("dblclick","dblclick",bA);bx("contextmenu","contextmenu",bA);return bA},by=function(bC,bD,bA){bD=bD||{};if(!bC.suspendedEndpoint){W(a1,bC.scope,bC)}if(!bD.doNotFireConnectionEvent&&bD.fireEvent!==false){var bB={connection:bC,source:bC.source,target:bC.target,sourceId:bC.sourceId,targetId:bC.targetId,sourceEndpoint:bC.endpoints[0],targetEndpoint:bC.endpoints[1]};br.fire("jsPlumbConnection",bB,bA);br.fire("connection",bB,bA)}br.anchorManager.newConnection(bC);be(bC.source)},bx=function(bA,bB,bC){bC.bind(bA,function(bE,bD){br.fire(bB,bC,bD)})},ay=function(bC){if(bC.container){return bC.container}else{var bA=n.CurrentLibrary.getTagName(bC.source),bB=n.CurrentLibrary.getParent(bC.source);if(bA&&bA.toLowerCase()==="td"){return n.CurrentLibrary.getParent(bB)}else{return bB}}},aH=function(bC){var bB=br.Defaults.EndpointType||ag;bC.parent=ay(bC);bC._jsPlumb=br;var bA=new bB(bC);bA.id="ep_"+am();bx("click","endpointClick",bA);bx("dblclick","endpointDblClick",bA);bx("contextmenu","contextmenu",bA);return bA},V=function(bC,bF,bE){var bA=aW[bC];if(bA&&bA.length){for(var bD=0;bD<bA.length;bD++){for(var bB=0;bB<bA[bD].connections.length;bB++){var bG=bF(bA[bD].connections[bB]);if(bG){return}}if(bE){bE(bA[bD])}}}},Z=function(bB){for(var bA in aW){V(bA,bB)}},aw=function(bA,bB){if(bA!=null&&bA.parentNode!=null){bA.parentNode.removeChild(bA)}},a0=function(bC,bB){for(var bA=0;bA<bC.length;bA++){aw(bC[bA],bB)}},bo=function(bB,bA){return aJ(bB,function(bC,bD){bq[bD]=bA;if(n.CurrentLibrary.isDragSupported(bC)){n.CurrentLibrary.setDraggable(bC,bA)}})},a8=function(bC,bD,bA){bD=bD==="block";var bB=null;if(bA){if(bD){bB=function(bF){bF.setVisible(true,true,true)}}else{bB=function(bF){bF.setVisible(false,true,true)}}}var bE=c(bC,"id");V(bE,function(bG){if(bD&&bA){var bF=bG.sourceId===bE?1:0;if(bG.endpoints[bF].isVisible()){bG.setVisible(true)}}else{bG.setVisible(bD)}},bB)},bm=function(bA){return aJ(bA,function(bC,bB){var bD=bq[bB]==null?false:bq[bB];bD=!bD;bq[bB]=bD;n.CurrentLibrary.setDraggable(bC,bD);return bD})},aT=function(bA,bC){var bB=null;if(bC){bB=function(bD){var bE=bD.isVisible();bD.setVisible(!bE)}}V(bA,function(bE){var bD=bE.isVisible();bE.setVisible(!bD)},bB)},X=function(bF){var bD=bF.timestamp,bA=bF.recalc,bE=bF.offset,bB=bF.elId;if(!bA){if(bD&&bD===bv[bB]){return ai[bB]}}if(bA||!bE){var bC=C(bB);if(bC!=null){af[bB]=a(bC);ai[bB]=s(bC);bv[bB]=bD}}else{ai[bB]=bE;if(af[bB]==null){var bC=C(bB);if(bC!=null){af[bB]=a(bC)}}}if(ai[bB]&&!ai[bB].right){ai[bB].right=ai[bB].left+af[bB][0];ai[bB].bottom=ai[bB].top+af[bB][1];ai[bB].width=af[bB][0];ai[bB].height=af[bB][1];ai[bB].centerx=ai[bB].left+(ai[bB].width/2);ai[bB].centery=ai[bB].top+(ai[bB].height/2)}return ai[bB]},aQ=function(bA){var bB=ai[bA];if(!bB){bB=X({elId:bA})}return{o:bB,s:af[bA]}},H=function(bA,bB,bD){var bC=C(bA);var bE=c(bC,"id");if(!bE||bE=="undefined"){if(arguments.length==2&&arguments[1]!=undefined){bE=bB}else{if(arguments.length==1||(arguments.length==3&&!arguments[2])){bE="jsPlumb_"+aO+"_"+am()}}d(bC,"id",bE)}return bE},ao=function(bC,bA,bB){bC=bC||function(){};bA=bA||function(){};return function(){var bD=null;try{bD=bA.apply(this,arguments)}catch(bE){o(br,"jsPlumb function failed : "+bE)}if(bB==null||(bD!==bB)){try{bC.apply(this,arguments)}catch(bE){o(br,"wrapped function failed : "+bE)}}return bD}};this.connectorClass="_jsPlumb_connector";this.endpointClass="_jsPlumb_endpoint";this.overlayClass="_jsPlumb_overlay";this.Anchors={};this.Connectors={canvas:{},svg:{},vml:{}};this.Endpoints={canvas:{},svg:{},vml:{}};this.Overlays={canvas:{},svg:{},vml:{}};this.addClass=function(bB,bA){return n.CurrentLibrary.addClass(bB,bA)};this.removeClass=function(bB,bA){return n.CurrentLibrary.removeClass(bB,bA)};this.hasClass=function(bB,bA){return n.CurrentLibrary.hasClass(bB,bA)};this.addEndpoint=function(bC,bD,bM){bM=bM||{};var bB=n.extend({},bM);n.extend(bB,bD);bB.endpoint=bB.endpoint||br.Defaults.Endpoint||n.Defaults.Endpoint;bB.paintStyle=bB.paintStyle||br.Defaults.EndpointStyle||n.Defaults.EndpointStyle;bC=aL(bC);var bE=[],bH=bC.length&&bC.constructor!=String?bC:[bC];for(var bF=0;bF<bH.length;bF++){var bK=C(bH[bF]),bA=H(bK);bB.source=bK;X({elId:bA});var bJ=aH(bB);if(bB.parentAnchor){bJ.parentAnchor=bB.parentAnchor}W(aW,bA,bJ);var bI=ai[bA],bG=af[bA];var bL=bJ.anchor.compute({xy:[bI.left,bI.top],wh:bG,element:bJ});bJ.paint({anchorLoc:bL});bE.push(bJ);if(!jsPlumbAdapter.headless){br.dragManager.endpointAdded(bK)}}return bE.length==1?bE[0]:bE};this.addEndpoints=function(bE,bB,bA){var bD=[];for(var bC=0;bC<bB.length;bC++){var bF=br.addEndpoint(bE,bB[bC],bA);if(l(bF)){Array.prototype.push.apply(bD,bF)}else{bD.push(bF)}}return bD};this.animate=function(bC,bB,bA){var bD=C(bC),bG=c(bC,"id");bA=bA||{};var bF=n.CurrentLibrary.dragEvents.step;var bE=n.CurrentLibrary.dragEvents.complete;bA[bF]=ao(bA[bF],function(){br.repaint(bG)});bA[bE]=ao(bA[bE],function(){br.repaint(bG)});n.CurrentLibrary.animate(bD,bB,bA)};this.checkCondition=function(bC,bE){var bA=br.getListener(bC);var bD=true;if(bA&&bA.length>0){try{for(var bB=0;bB<bA.length;bB++){bD=bD&&bA[bB](bE)}}catch(bF){o(br,"cannot check condition ["+bC+"]"+bF)}}return bD};this.connect=function(bD,bB){var bA=aC(bD,bB),bC;if(bA){if(bA.deleteEndpointsOnDetach==null){bA.deleteEndpointsOnDetach=true}bC=ae(bA);by(bC,bA)}return bC};this.deleteEndpoint=function(bB){var bG=(typeof bB=="string")?aX[bB]:bB;if(bG){var bD=bG.getUuid();if(bD){aX[bD]=null}bG.detachAll();if(bG.endpoint.cleanup){bG.endpoint.cleanup()}a0(bG.endpoint.getDisplayElements());br.anchorManager.deleteEndpoint(bG);for(var bF in aW){var bA=aW[bF];if(bA){var bE=[];for(var bC=0;bC<bA.length;bC++){if(bA[bC]!=bG){bE.push(bA[bC])}}aW[bF]=bE}}if(!jsPlumbAdapter.headless){br.dragManager.endpointDeleted(bG)}}};this.deleteEveryEndpoint=function(){br.setSuspendDrawing(true);for(var bC in aW){var bA=aW[bC];if(bA&&bA.length){for(var bB=0;bB<bA.length;bB++){br.deleteEndpoint(bA[bB])}}}delete aW;aW={};delete aX;aX={};br.setSuspendDrawing(false,true)};var bb=function(bD,bF,bA){var bC=br.Defaults.ConnectionType||br.getDefaultConnectionType(),bB=bD.constructor==bC,bE=bB?{connection:bD,source:bD.source,target:bD.target,sourceId:bD.sourceId,targetId:bD.targetId,sourceEndpoint:bD.endpoints[0],targetEndpoint:bD.endpoints[1]}:bD;if(bF){br.fire("jsPlumbConnectionDetached",bE,bA);br.fire("connectionDetached",bE,bA)}br.anchorManager.connectionDetached(bE)},a9=function(bA){br.fire("connectionDrag",bA)},aU=function(bA){br.fire("connectionDragStop",bA)};this.detach=function(){if(arguments.length==0){return}var bE=br.Defaults.ConnectionType||br.getDefaultConnectionType(),bF=arguments[0].constructor==bE,bD=arguments.length==2?bF?(arguments[1]||{}):arguments[0]:arguments[0],bI=(bD.fireEvent!==false),bC=bD.forceDetach,bB=bF?arguments[0]:bD.connection;if(bB){if(bC||(bB.isDetachAllowed(bB)&&bB.endpoints[0].isDetachAllowed(bB)&&bB.endpoints[1].isDetachAllowed(bB))){if(bC||br.checkCondition("beforeDetach",bB)){bB.endpoints[0].detach(bB,false,true,bI)}}}else{var bA=n.extend({},bD);if(bA.uuids){ax(bA.uuids[0]).detachFrom(ax(bA.uuids[1]),bI)}else{if(bA.sourceEndpoint&&bA.targetEndpoint){bA.sourceEndpoint.detachFrom(bA.targetEndpoint)}else{var bH=H(bA.source),bG=H(bA.target);V(bH,function(bJ){if((bJ.sourceId==bH&&bJ.targetId==bG)||(bJ.targetId==bH&&bJ.sourceId==bG)){if(br.checkCondition("beforeDetach",bJ)){bJ.endpoints[0].detach(bJ,false,true,bI)}}})}}}};this.detachAllConnections=function(bC,bD){bD=bD||{};bC=C(bC);var bE=c(bC,"id"),bA=aW[bE];if(bA&&bA.length){for(var bB=0;bB<bA.length;bB++){bA[bB].detachAll(bD.fireEvent)}}};this.detachEveryConnection=function(bC){bC=bC||{};for(var bD in aW){var bA=aW[bD];if(bA&&bA.length){for(var bB=0;bB<bA.length;bB++){bA[bB].detachAll(bC.fireEvent)}}}delete a1;a1={}};this.draggable=function(bC,bA){if(typeof bC=="object"&&bC.length){for(var bB=0;bB<bC.length;bB++){var bD=C(bC[bB]);if(bD){bg(bD,true,bA)}}}else{if(bC._nodes){for(var bB=0;bB<bC._nodes.length;bB++){var bD=C(bC._nodes[bB]);if(bD){bg(bD,true,bA)}}}else{var bD=C(bC);if(bD){bg(bD,true,bA)}}}};this.extend=function(bB,bA){return n.CurrentLibrary.extend(bB,bA)};this.getDefaultEndpointType=function(){return ag};this.getDefaultConnectionType=function(){return az};var bu=function(bE,bD,bB,bA){for(var bC=0;bC<bE.length;bC++){bE[bC][bD].apply(bE[bC],bB)}return bA(bE)},T=function(bE,bD,bB){var bA=[];for(var bC=0;bC<bE.length;bC++){bA.push([bE[bC][bD].apply(bE[bC],bB),bE[bC]])}return bA},ap=function(bC,bB,bA){return function(){return bu(bC,bB,arguments,bA)}},aA=function(bB,bA){return function(){return T(bB,bA,arguments)}},bw=function(bA,bD){var bC=[];if(bA){if(typeof bA=="string"){if(bA==="*"){return bA}bC.push(bA)}else{if(bD){bC=bA}else{for(var bB=0;bB<bA.length;bB++){bC.push(H(C(bA[bB])))}}}}return bC},aI=function(bC,bB,bA){if(bC==="*"){return true}return bC.length>0?G(bC,bB)!=-1:!bA};this.getConnections=function(bJ,bB){if(!bJ){bJ={}}else{if(bJ.constructor==String){bJ={scope:bJ}}}var bI=bJ.scope||br.getDefaultScope(),bH=bw(bI,true),bA=bw(bJ.source),bF=bw(bJ.target),bE=(!bB&&bH.length>1)?{}:[],bK=function(bM,bN){if(!bB&&bH.length>1){var bL=bE[bM];if(bL==null){bL=[];bE[bM]=bL}bL.push(bN)}else{bE.push(bN)}};for(var bD in a1){if(aI(bH,bD)){for(var bC=0;bC<a1[bD].length;bC++){var bG=a1[bD][bC];if(aI(bA,bG.sourceId)&&aI(bF,bG.targetId)){bK(bD,bG)}}}}return bE};var L=function(bA,bB){return function(bD){for(var bC=0;bC<bA.length;bC++){bD(bA[bC])}return bB(bA)}},P=function(bA){return function(bB){return bA[bB]}};var Q=function(bA,bB){return{setHover:ap(bA,"setHover",bB),removeAllOverlays:ap(bA,"removeAllOverlays",bB),setLabel:ap(bA,"setLabel",bB),addOverlay:ap(bA,"addOverlay",bB),removeOverlay:ap(bA,"removeOverlay",bB),removeOverlays:ap(bA,"removeOverlays",bB),showOverlay:ap(bA,"showOverlay",bB),hideOverlay:ap(bA,"hideOverlay",bB),showOverlays:ap(bA,"showOverlays",bB),hideOverlays:ap(bA,"hideOverlays",bB),setPaintStyle:ap(bA,"setPaintStyle",bB),setHoverPaintStyle:ap(bA,"setHoverPaintStyle",bB),setParameter:ap(bA,"setParameter",bB),setParameters:ap(bA,"setParameters",bB),setVisible:ap(bA,"setVisible",bB),setZIndex:ap(bA,"setZIndex",bB),repaint:ap(bA,"repaint",bB),addType:ap(bA,"addType",bB),toggleType:ap(bA,"toggleType",bB),removeType:ap(bA,"removeType",bB),getLabel:aA(bA,"getLabel"),getOverlay:aA(bA,"getOverlay"),isHover:aA(bA,"isHover"),getParameter:aA(bA,"getParameter"),getParameters:aA(bA,"getParameters"),getPaintStyle:aA(bA,"getPaintStyle"),getHoverPaintStyle:aA(bA,"getHoverPaintStyle"),isVisible:aA(bA,"isVisible"),getZIndex:aA(bA,"getZIndex"),hasType:aA(bA,"hasType"),getType:aA(bA,"getType"),length:bA.length,each:L(bA,bB),get:P(bA)}};var aN=function(bB){var bA=Q(bB,aN);return n.CurrentLibrary.extend(bA,{setDetachable:ap(bB,"setDetachable",aN),setConnector:ap(bB,"setConnector",aN),detach:function(){for(var bC=0;bC<bB.length;bC++){br.detach(bB[bC])}},isDetachable:aA(bB,"isDetachable")})};var bf=function(bB){var bA=Q(bB,bf);return n.CurrentLibrary.extend(bA,{setEnabled:ap(bB,"setEnabled",bf),isEnabled:aA(bB,"isEnabled"),detachAll:function(){for(var bC=0;bC<bB.length;bC++){bB[bC].detachAll()}},"delete":function(){for(var bC=0;bC<bB.length;bC++){br.deleteEndpoint(bB[bC])}}})};this.select=function(bA){bA=bA||{};bA.scope=bA.scope||"*";var bB=br.getConnections(bA,true);return aN(bB)};this.selectEndpoints=function(bI){bI=bI||{};bI.scope=bI.scope||"*";var bN=!bI.element&&!bI.source&&!bI.target,bB=bN?"*":bw(bI.element),bC=bN?"*":bw(bI.source),bK=bN?"*":bw(bI.target),bP=bw(bI.scope,true);var bQ=[];for(var bG in aW){var bE=aI(bB,bG,true),bA=aI(bC,bG,true),bF=bC!="*",bL=aI(bK,bG,true),bD=bK!="*";if(bE||bA||bL){inner:for(var bJ=0;bJ<aW[bG].length;bJ++){var bM=aW[bG][bJ];if(aI(bP,bM.scope,true)){var bO=(bF&&bC.length>0&&!bM.isSource),bH=(bD&&bK.length>0&&!bM.isTarget);if(bO||bH){continue inner}bQ.push(bM)}}}}return bf(bQ)};this.getAllConnections=function(){return a1};this.getDefaultScope=function(){return R};this.getEndpoint=ax;this.getEndpoints=function(bA){return aW[H(bA)]};this.getId=H;this.getOffset=function(bB){var bA=ai[bB];return X({elId:bB})};this.getSelector=function(bA){return n.CurrentLibrary.getSelector(bA)};this.getSize=function(bB){var bA=af[bB];if(!bA){X({elId:bB})}return af[bB]};this.appendElement=aY;var aV=false;this.isHoverSuspended=function(){return aV};this.setHoverSuspended=function(bA){aV=bA};var aZ=function(bA){return function(){return jsPlumbAdapter.isRenderModeAvailable(bA)}};this.isCanvasAvailable=aZ("canvas");this.isSVGAvailable=aZ("svg");this.isVMLAvailable=aZ("vml");this.hide=function(bA,bB){a8(bA,"none",bB)};this.idstamp=am;this.init=function(){if(!K){br.setRenderMode(br.Defaults.RenderMode);var bA=function(bB){n.CurrentLibrary.bind(document,bB,function(bH){if(!br.currentlyDragging&&Y==n.CANVAS){for(var bG in a1){var bI=a1[bG];for(var bE=0;bE<bI.length;bE++){var bD=bI[bE].connector[bB](bH);if(bD){return}}}for(var bF in aW){var bC=aW[bF];for(var bE=0;bE<bC.length;bE++){if(bC[bE].endpoint[bB](bH)){return}}}}})};bA("click");bA("dblclick");bA("mousemove");bA("mousedown");bA("mouseup");bA("contextmenu");K=true;br.fire("ready")}};this.log=O;this.jsPlumbUIComponent=B;this.makeAnchor=function(){if(arguments.length==0){return null}var bF=arguments[0],bC=arguments[1],bB=arguments[2],bD=null;if(bF.compute&&bF.getOrientation){return bF}else{if(typeof bF=="string"){bD=n.Anchors[arguments[0]]({elementId:bC,jsPlumbInstance:br})}else{if(l(bF)){if(l(bF[0])||z(bF[0])){if(bF.length==2&&z(bF[0])&&u(bF[1])){var bA=n.extend({elementId:bC,jsPlumbInstance:br},bF[1]);bD=n.Anchors[bF[0]](bA)}else{bD=new at(bF,null,bC)}}else{var bE={x:bF[0],y:bF[1],orientation:(bF.length>=4)?[bF[2],bF[3]]:[0,0],offsets:(bF.length==6)?[bF[4],bF[5]]:[0,0],elementId:bC};bD=new ab(bE);bD.clone=function(){return new ab(bE)}}}}}if(!bD.id){bD.id="anchor_"+am()}return bD};this.makeAnchors=function(bD,bB,bA){var bE=[];for(var bC=0;bC<bD.length;bC++){if(typeof bD[bC]=="string"){bE.push(n.Anchors[bD[bC]]({elementId:bB,jsPlumbInstance:bA}))}else{if(l(bD[bC])){bE.push(br.makeAnchor(bD[bC],bB,bA))}}}return bE};this.makeDynamicAnchor=function(bA,bB){return new at(bA,bB)};var a2={},aK={},bl={},ar={},ac=function(bA,bB){bA.paintStyle=bA.paintStyle||br.Defaults.EndpointStyles[bB]||br.Defaults.EndpointStyle||n.Defaults.EndpointStyles[bB]||n.Defaults.EndpointStyle;bA.hoverPaintStyle=bA.hoverPaintStyle||br.Defaults.EndpointHoverStyles[bB]||br.Defaults.EndpointHoverStyle||n.Defaults.EndpointHoverStyles[bB]||n.Defaults.EndpointHoverStyle;bA.anchor=bA.anchor||br.Defaults.Anchors[bB]||br.Defaults.Anchor||n.Defaults.Anchors[bB]||n.Defaults.Anchor;bA.endpoint=bA.endpoint||br.Defaults.Endpoints[bB]||br.Defaults.Endpoint||n.Defaults.Endpoints[bB]||n.Defaults.Endpoint};this.makeTarget=function(bD,bE,bK){var bB=n.extend({_jsPlumb:br},bK);n.extend(bB,bE);ac(bB,1);var bI=n.CurrentLibrary,bJ=bB.scope||br.Defaults.Scope,bF=!(bB.deleteEndpointsOnDetach===false),bC=bB.maxConnections||-1,bA=bB.onMaxConnections;_doOne=function(bP){var bN=H(bP);a2[bN]=bB;bl[bN]=bB.uniqueEndpoint,ar[bN]=bC,al[bN]=true,proxyComponent=new B(bB);var bM=n.extend({},bB.dropOptions||{}),bL=function(){var bS=n.CurrentLibrary.getDropEvent(arguments),bU=br.select({target:bN}).length;br.currentlyDragging=false;var b4=C(bI.getDragObject(arguments)),bT=c(b4,"dragId"),b2=c(b4,"originalScope"),bZ=bk[bT],bR=bZ.endpoints[0],bQ=bB.endpoint?n.extend({},bB.endpoint):{};if(!al[bN]||ar[bN]>0&&bU>=ar[bN]){if(bA){bA({element:bP,connection:bZ},bS)}return false}bR.anchor.locked=false;if(b2){bI.setDragScope(b4,b2)}var bX=proxyComponent.isDropAllowed(bZ.sourceId,H(bP),bZ.scope,bZ,null);if(bZ.endpointsToDeleteOnDetach){if(bR===bZ.endpointsToDeleteOnDetach[0]){bZ.endpointsToDeleteOnDetach[0]=null}else{if(bR===bZ.endpointsToDeleteOnDetach[1]){bZ.endpointsToDeleteOnDetach[1]=null}}}if(bZ.suspendedEndpoint){bZ.targetId=bZ.suspendedEndpoint.elementId;bZ.target=bI.getElementObject(bZ.suspendedEndpoint.elementId);bZ.endpoints[1]=bZ.suspendedEndpoint}if(bX){bR.detach(bZ,false,true,false);var b3=aK[bN]||br.addEndpoint(bP,bB);if(bB.uniqueEndpoint){aK[bN]=b3}b3._makeTargetCreator=true;if(b3.anchor.positionFinder!=null){var b0=bI.getUIPosition(arguments),bW=bI.getOffset(bP),b1=bI.getSize(bP),bV=b3.anchor.positionFinder(b0,bW,b1,b3.anchor.constructorParams);b3.anchor.x=bV[0];b3.anchor.y=bV[1]}var bY=br.connect({source:bR,target:b3,scope:b2,previousConnection:bZ,container:bZ.parent,deleteEndpointsOnDetach:bF,doNotFireConnectionEvent:bR.endpointWillMoveAfterConnection});if(bZ.endpoints[1]._makeTargetCreator&&bZ.endpoints[1].connections.length<2){br.deleteEndpoint(bZ.endpoints[1])}if(bF){bY.endpointsToDeleteOnDetach=[bR,b3]}bY.repaint()}else{if(bZ.suspendedEndpoint){if(bR.isReattach){bZ.setHover(false);bZ.floatingAnchorIndex=null;bZ.suspendedEndpoint.addConnection(bZ);br.repaint(bR.elementId)}else{bR.detach(bZ,false,true,true,bS)}}}};var bO=bI.dragEvents.drop;bM.scope=bM.scope||bJ;bM[bO]=ao(bM[bO],bL);bI.initDroppable(bP,bM,true)};bD=aL(bD);var bH=bD.length&&bD.constructor!=String?bD:[bD];for(var bG=0;bG<bH.length;bG++){_doOne(C(bH[bG]))}return br};this.unmakeTarget=function(bB,bC){bB=n.CurrentLibrary.getElementObject(bB);var bA=H(bB);if(!bC){delete a2[bA];delete bl[bA];delete ar[bA];delete al[bA]}return br};this.makeTargets=function(bC,bD,bA){for(var bB=0;bB<bC.length;bB++){br.makeTarget(bC[bB],bD,bA)}};var aB={},a7={},bd={},ad={},J={},N={},al={};this.makeSource=function(bE,bF,bJ){var bC=n.extend({},bJ);n.extend(bC,bF);ac(bC,0);var bI=n.CurrentLibrary,bD=bC.maxConnections||-1,bB=bC.onMaxConnections,bA=function(bR){var bL=H(bR),bS=bC.parent,bK=bS!=null?br.getId(bI.getElementObject(bS)):bL;aB[bK]=bC;bd[bK]=bC.uniqueEndpoint;ad[bK]=true;var bM=bI.dragEvents.stop,bQ=bI.dragEvents.drag,bT=n.extend({},bC.dragOptions||{}),bO=bT.drag,bU=bT.stop,bV=null,bP=false;N[bK]=bD;bT.scope=bT.scope||bC.scope;bT[bQ]=ao(bT[bQ],function(){if(bO){bO.apply(this,arguments)}bP=false});bT[bM]=ao(bT[bM],function(){if(bU){bU.apply(this,arguments)}br.currentlyDragging=false;if(bV.connections.length==0){br.deleteEndpoint(bV)}else{bI.unbind(bV.canvas,"mousedown");var bX=bC.anchor||br.Defaults.Anchor,bY=bV.anchor,b0=bV.connections[0];bV.anchor=br.makeAnchor(bX,bL,br);if(bC.parent){var bZ=bI.getElementObject(bC.parent);if(bZ){var bW=bV.elementId;var b1=bC.container||br.Defaults.Container||n.Defaults.Container;bV.setElement(bZ,b1);bV.endpointWillMoveAfterConnection=false;br.anchorManager.rehomeEndpoint(bW,bZ);b0.previousConnection=null;A(a1[b0.scope],function(b2){return b2.id===b0.id});br.anchorManager.connectionDetached({sourceId:b0.sourceId,targetId:b0.targetId,connection:b0});by(b0)}}bV.repaint();br.repaint(bV.elementId);br.repaint(b0.targetId)}});var bN=function(b0){if(!ad[bK]){return}var bY=br.select({source:bK}).length;if(N[bK]>=0&&bY>=N[bK]){if(bB){bB({element:bR,maxConnections:bD},b0)}return false}if(bF.filter){var bW=bF.filter(bI.getOriginalEvent(b0),bR);if(bW===false){return}}var b4=X({elId:bL});var b3=((b0.pageX||b0.page.x)-b4.left)/b4.width,b2=((b0.pageY||b0.page.y)-b4.top)/b4.height,b8=b3,b7=b2;if(bC.parent){var b1=bI.getElementObject(bC.parent),bZ=H(b1);b4=X({elId:bZ});b8=((b0.pageX||b0.page.x)-b4.left)/b4.width,b7=((b0.pageY||b0.page.y)-b4.top)/b4.height}var b6={};n.extend(b6,bC);b6.isSource=true;b6.anchor=[b3,b2,0,0];b6.parentAnchor=[b8,b7,0,0];b6.dragOptions=bT;if(bC.parent){var bX=b6.container||br.Defaults.Container||n.Defaults.Container;if(bX){b6.container=bX}else{b6.container=n.CurrentLibrary.getParent(bC.parent)}}bV=br.addEndpoint(bL,b6);bP=true;bV.endpointWillMoveAfterConnection=bC.parent!=null;bV.endpointWillMoveTo=bC.parent?bI.getElementObject(bC.parent):null;var b5=function(){if(bP){br.deleteEndpoint(bV)}};br.registerListener(bV.canvas,"mouseup",b5);br.registerListener(bR,"mouseup",b5);bI.trigger(bV.canvas,"mousedown",b0)};br.registerListener(bR,"mousedown",bN);J[bL]=bN};bE=aL(bE);var bH=bE.length&&bE.constructor!=String?bE:[bE];for(var bG=0;bG<bH.length;bG++){bA(C(bH[bG]))}return br};this.unmakeSource=function(bB,bC){bB=n.CurrentLibrary.getElementObject(bB);var bD=H(bB),bA=J[bD];if(bA){br.unregisterListener(_el,"mousedown",bA)}if(!bC){delete aB[bD];delete bd[bD];delete ad[bD];delete J[bD];delete N[bD]}return br};this.unmakeEverySource=function(){for(var bA in ad){br.unmakeSource(bA,true)}aB={};bd={};ad={};J={}};this.unmakeEveryTarget=function(){for(var bA in al){br.unmakeTarget(bA,true)}a2={};bl={};ar={};al={};return br};this.makeSources=function(bC,bD,bA){for(var bB=0;bB<bC.length;bB++){br.makeSource(bC[bB],bD,bA)}return br};var aP=function(bE,bD,bF,bA){var bB=bE=="source"?ad:al;if(z(bD)){bB[bD]=bA?!bB[bD]:bF}else{if(bD.length){bD=aL(bD);for(var bC=0;bC<bD.length;bC++){var bG=_el=n.CurrentLibrary.getElementObject(bD[bC]),bG=H(_el);bB[bG]=bA?!bB[bG]:bF}}}return br};this.setSourceEnabled=function(bA,bB){return aP("source",bA,bB)};this.toggleSourceEnabled=function(bA){aP("source",bA,null,true);return br.isSourceEnabled(bA)};this.isSource=function(bA){bA=n.CurrentLibrary.getElementObject(bA);return ad[H(bA)]!=null};this.isSourceEnabled=function(bA){bA=n.CurrentLibrary.getElementObject(bA);return ad[H(bA)]===true};this.setTargetEnabled=function(bA,bB){return aP("target",bA,bB)};this.toggleTargetEnabled=function(bA){return aP("target",bA,null,true);return br.isTargetEnabled(bA)};this.isTarget=function(bA){bA=n.CurrentLibrary.getElementObject(bA);return al[H(bA)]!=null};this.isTargetEnabled=function(bA){bA=n.CurrentLibrary.getElementObject(bA);return al[H(bA)]===true};this.ready=function(bA){br.bind("ready",bA)},this.repaint=function(bB,bD,bC){if(typeof bB=="object"){for(var bA=0;bA<bB.length;bA++){be(C(bB),bD,bC)}}else{be(C(bB),bD,bC)}};this.repaintEverything=function(){for(var bA in aW){be(C(bA),null,null)}};this.removeAllEndpoints=function(bC){var bA=c(bC,"id"),bD=aW[bA];if(bD){for(var bB=0;bB<bD.length;bB++){br.deleteEndpoint(bD[bB])}}aW[bA]=[]};this.removeEveryEndpoint=this.deleteEveryEndpoint;this.removeEndpoint=function(bA,bB){br.deleteEndpoint(bB)};var ah={},bi=function(){for(var bB in ah){for(var bA=0;bA<ah[bB].length;bA++){var bC=ah[bB][bA];n.CurrentLibrary.unbind(bC.el,bC.event,bC.listener)}}ah={}};this.registerListener=function(bB,bA,bC){n.CurrentLibrary.bind(bB,bA,bC);W(ah,bA,{el:bB,event:bA,listener:bC})};this.unregisterListener=function(bB,bA,bC){n.CurrentLibrary.unbind(bB,bA,bC);A(ah,function(bD){return bD.type==bA&&bD.listener==bC})};this.reset=function(){br.deleteEveryEndpoint();br.unbind();a2={};aK={};bl={};ar={};aB={};a7={};bd={};N={};bi();br.anchorManager.reset();if(!jsPlumbAdapter.headless){br.dragManager.reset()}};this.setDefaultScope=function(bA){R=bA};this.setDraggable=bo;this.setId=function(bE,bA,bG){var bH=bE.constructor==String?bE:br.getId(bE),bD=br.getConnections({source:bH,scope:"*"},true),bC=br.getConnections({target:bH,scope:"*"},true);bA=""+bA;if(!bG){bE=n.CurrentLibrary.getElementObject(bH);n.CurrentLibrary.setAttribute(bE,"id",bA)}bE=n.CurrentLibrary.getElementObject(bA);aW[bA]=aW[bH]||[];for(var bB=0;bB<aW[bA].length;bB++){aW[bA][bB].elementId=bA;aW[bA][bB].element=bE;aW[bA][bB].anchor.elementId=bA}delete aW[bH];br.anchorManager.changeId(bH,bA);var bF=function(bL,bI,bK){for(var bJ=0;bJ<bL.length;bJ++){bL[bJ].endpoints[bI].elementId=bA;bL[bJ].endpoints[bI].element=bE;bL[bJ][bK+"Id"]=bA;bL[bJ][bK]=bE}};bF(bD,0,"source");bF(bC,1,"target")};this.setIdChanged=function(bB,bA){br.setId(bB,bA,true)};this.setDebugLog=function(bA){O=bA};this.setRepaintFunction=function(bA){au=bA};var ba=false;this.setSuspendDrawing=function(bB,bA){ba=bB;if(bA){br.repaintEverything()}};this.isSuspendDrawing=function(){return ba};this.CANVAS="canvas";this.SVG="svg";this.VML="vml";this.setRenderMode=function(bA){Y=jsPlumbAdapter.setRenderMode(bA);return Y};this.getRenderMode=function(){return Y};this.show=function(bA,bB){a8(bA,"block",bB)};this.sizeCanvas=function(bC,bA,bE,bB,bD){if(bC){bC.style.height=bD+"px";bC.height=bD;bC.style.width=bB+"px";bC.width=bB;bC.style.left=bA+"px";bC.style.top=bE+"px"}};this.getTestHarness=function(){return{endpointsByElement:aW,endpointCount:function(bA){var bB=aW[bA];return bB?bB.length:0},connectionCount:function(bA){bA=bA||R;var bB=a1[bA];return bB?bB.length:0},getId:H,makeAnchor:self.makeAnchor,makeDynamicAnchor:self.makeDynamicAnchor}};this.toggle=aT;this.toggleVisible=aT;this.toggleDraggable=bm;this.unload=function(){};this.wrap=ao;this.addListener=this.bind;var bs=function(bF,bC){var bD=null,bA=bF;if(bC.tagName.toLowerCase()==="svg"&&bC.parentNode){bD=bC.parentNode}else{if(bC.offsetParent){bD=bC.offsetParent}}if(bD!=null){var bB=bD.tagName.toLowerCase()==="body"?{left:0,top:0}:s(bD),bE=bD.tagName.toLowerCase()==="body"?{left:0,top:0}:{left:bD.scrollLeft,top:bD.scrollTop};bA[0]=bF[0]-bB.left+bE.left;bA[1]=bF[1]-bB.top+bE.top}return bA};var ab=function(bE){var bC=this;this.x=bE.x||0;this.y=bE.y||0;this.elementId=bE.elementId;var bB=bE.orientation||[0,0];var bD=null,bA=null;this.offsets=bE.offsets||[0,0];bC.timestamp=null;this.compute=function(bJ){var bI=bJ.xy,bF=bJ.wh,bG=bJ.element,bH=bJ.timestamp;if(bH&&bH===bC.timestamp){return bA}bA=[bI[0]+(bC.x*bF[0])+bC.offsets[0],bI[1]+(bC.y*bF[1])+bC.offsets[1]];bA=bs(bA,bG.canvas);bC.timestamp=bH;return bA};this.getOrientation=function(bF){return bB};this.equals=function(bF){if(!bF){return false}var bG=bF.getOrientation();var bH=this.getOrientation();return this.x==bF.x&&this.y==bF.y&&this.offsets[0]==bF.offsets[0]&&this.offsets[1]==bF.offsets[1]&&bH[0]==bG[0]&&bH[1]==bG[1]};this.getCurrentLocation=function(){return bA}};var a4=function(bG){var bE=bG.reference,bF=bG.referenceCanvas,bC=a(C(bF)),bB=0,bH=0,bA=null,bD=null;this.x=0;this.y=0;this.isFloating=true;this.compute=function(bL){var bK=bL.xy,bJ=bL.element,bI=[bK[0]+(bC[0]/2),bK[1]+(bC[1]/2)];bI=bs(bI,bJ.canvas);bD=bI;return bI};this.getOrientation=function(bJ){if(bA){return bA}else{var bI=bE.getOrientation(bJ);return[Math.abs(bI[0])*bB*-1,Math.abs(bI[1])*bH*-1]}};this.over=function(bI){bA=bI.getOrientation()};this.out=function(){bA=null};this.getCurrentLocation=function(){return bD}};var at=function(bC,bB,bH){this.isSelective=true;this.isDynamic=true;var bK=[],bJ=this,bI=function(bL){return bL.constructor==ab?bL:br.makeAnchor(bL,bH,br)};for(var bG=0;bG<bC.length;bG++){bK[bG]=bI(bC[bG])}this.addAnchor=function(bL){bK.push(bI(bL))};this.getAnchors=function(){return bK};this.locked=false;var bD=bK.length>0?bK[0]:null,bF=bK.length>0?0:-1,bJ=this,bE=function(bN,bL,bR,bQ,bM){var bP=bQ[0]+(bN.x*bM[0]),bO=bQ[1]+(bN.y*bM[1]);return Math.sqrt(Math.pow(bL-bP,2)+Math.pow(bR-bO,2))},bA=bB||function(bV,bM,bN,bO,bL){var bQ=bN[0]+(bO[0]/2),bP=bN[1]+(bO[1]/2);var bS=-1,bU=Infinity;for(var bR=0;bR<bL.length;bR++){var bT=bE(bL[bR],bQ,bP,bV,bM);if(bT<bU){bS=bR+0;bU=bT}}return bL[bS]};this.compute=function(bP){var bO=bP.xy,bL=bP.wh,bN=bP.timestamp,bM=bP.txy,bQ=bP.twh;if(bJ.locked||bM==null||bQ==null){return bD.compute(bP)}else{bP.timestamp=null}bD=bA(bO,bL,bM,bQ,bK);bJ.x=bD.x;bJ.y=bD.y;return bD.compute(bP)};this.getCurrentLocation=function(){return bD!=null?bD.getCurrentLocation():null};this.getOrientation=function(bL){return bD!=null?bD.getOrientation(bL):[0,0]};this.over=function(bL){if(bD!=null){bD.over(bL)}};this.out=function(){if(bD!=null){bD.out()}}};var bn={},aj={},aM={},U={HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"},bp=function(bJ,bK,bG,bD){if(bJ===bK){return{orientation:U.IDENTITY,a:["top","top"]}}var bB=Math.atan2((bD.centery-bG.centery),(bD.centerx-bG.centerx)),bE=Math.atan2((bG.centery-bD.centery),(bG.centerx-bD.centerx)),bF=((bG.left<=bD.left&&bG.right>=bD.left)||(bG.left<=bD.right&&bG.right>=bD.right)||(bG.left<=bD.left&&bG.right>=bD.right)||(bD.left<=bG.left&&bD.right>=bG.right)),bL=((bG.top<=bD.top&&bG.bottom>=bD.top)||(bG.top<=bD.bottom&&bG.bottom>=bD.bottom)||(bG.top<=bD.top&&bG.bottom>=bD.bottom)||(bD.top<=bG.top&&bD.bottom>=bG.bottom));if(!(bF||bL)){var bI=null,bC=false,bA=false,bH=null;if(bD.left>bG.left&&bD.top>bG.top){bI=["right","top"]}else{if(bD.left>bG.left&&bG.top>bD.top){bI=["top","left"]}else{if(bD.left<bG.left&&bD.top<bG.top){bI=["top","right"]}else{if(bD.left<bG.left&&bD.top>bG.top){bI=["left","top"]}}}}return{orientation:U.DIAGONAL,a:bI,theta:bB,theta2:bE}}else{if(bF){return{orientation:U.HORIZONTAL,a:bG.top<bD.top?["bottom","top"]:["top","bottom"],theta:bB,theta2:bE}}else{return{orientation:U.VERTICAL,a:bG.left<bD.left?["right","left"]:["left","right"],theta:bB,theta2:bE}}}},a6=function(bO,bK,bI,bJ,bP,bL,bC){var bQ=[],bB=bK[bP?0:1]/(bJ.length+1);for(var bM=0;bM<bJ.length;bM++){var bR=(bM+1)*bB,bA=bL*bK[bP?1:0];if(bC){bR=bK[bP?0:1]-bR}var bH=(bP?bR:bA),bE=bI[0]+bH,bG=bH/bK[0],bF=(bP?bA:bR),bD=bI[1]+bF,bN=bF/bK[1];bQ.push([bE,bD,bG,bN,bJ[bM][1],bJ[bM][2]])}return bQ},bc=function(bB,bA){return bB[0]>bA[0]?1:-1},aa=function(bA){return function(bC,bB){var bD=true;if(bA){if(bC[0][0]<bB[0][0]){bD=true}else{bD=bC[0][1]>bB[0][1]}}else{if(bC[0][0]>bB[0][0]){bD=true}else{bD=bC[0][1]>bB[0][1]}}return bD===false?-1:1}},M=function(bB,bA){var bD=bB[0][0]<0?-Math.PI-bB[0][0]:Math.PI-bB[0][0],bC=bA[0][0]<0?-Math.PI-bA[0][0]:Math.PI-bA[0][0];if(bD>bC){return 1}else{return bB[0][1]>bA[0][1]?1:-1}},a3={top:bc,right:aa(true),bottom:aa(true),left:M},aq=function(bA,bB){return bA.sort(bB)},an=function(bB,bA){var bD=af[bB],bE=ai[bB],bC=function(bL,bS,bH,bK,bQ,bP,bG){if(bK.length>0){var bO=aq(bK,a3[bL]),bM=bL==="right"||bL==="top",bF=a6(bL,bS,bH,bO,bQ,bP,bM);var bT=function(bW,bV){var bU=bs([bV[0],bV[1]],bW.canvas);aj[bW.id]=[bU[0],bU[1],bV[2],bV[3]];aM[bW.id]=bG};for(var bI=0;bI<bF.length;bI++){var bN=bF[bI][4],bR=bN.endpoints[0].elementId===bB,bJ=bN.endpoints[1].elementId===bB;if(bR){bT(bN.endpoints[0],bF[bI])}else{if(bJ){bT(bN.endpoints[1],bF[bI])}}}}};bC("bottom",bD,[bE.left,bE.top],bA.bottom,true,1,[0,1]);bC("top",bD,[bE.left,bE.top],bA.top,true,0,[0,-1]);bC("left",bD,[bE.left,bE.top],bA.left,false,0,[-1,0]);bC("right",bD,[bE.left,bE.top],bA.right,false,1,[1,0])},aG=function(){var bA={},bE={},bB=this,bD={};this.reset=function(){bA={};bE={};bD={}};this.newConnection=function(bI){var bK=bI.sourceId,bH=bI.targetId,bF=bI.endpoints,bJ=true,bG=function(bL,bM,bO,bN,bP){if((bK==bH)&&bO.isContinuous){n.CurrentLibrary.removeElement(bF[1].canvas);bJ=false}W(bE,bN,[bP,bM,bO.constructor==at])};bG(0,bF[0],bF[0].anchor,bH,bI);if(bJ){bG(1,bF[1],bF[1].anchor,bK,bI)}};this.connectionDetached=function(bF){var bG=bF.connection||bF;var bL=bG.sourceId,bM=bG.targetId,bP=bG.endpoints,bK=function(bQ,bR,bT,bS,bU){if(bT.constructor==a4){}else{A(bE[bS],function(bV){return bV[0].id==bU.id})}};bK(1,bP[1],bP[1].anchor,bL,bG);bK(0,bP[0],bP[0].anchor,bM,bG);var bH=bG.sourceId,bI=bG.targetId,bO=bG.endpoints[0].id,bJ=bG.endpoints[1].id,bN=function(bS,bQ){if(bS){var bR=function(bT){return bT[4]==bQ};A(bS.top,bR);A(bS.left,bR);A(bS.bottom,bR);A(bS.right,bR)}};bN(bD[bH],bO);bN(bD[bI],bJ);bB.redraw(bH);bB.redraw(bI)};this.add=function(bG,bF){W(bA,bF,bG)};this.changeId=function(bG,bF){bE[bF]=bE[bG];bA[bF]=bA[bG];delete bE[bG];delete bA[bG]};this.getConnectionsFor=function(bF){return bE[bF]||[]};this.getEndpointsFor=function(bF){return bA[bF]||[]};this.deleteEndpoint=function(bF){A(bA[bF.elementId],function(bG){return bG.id==bF.id})};this.clearFor=function(bF){delete bA[bF];bA[bF]=[]};var bC=function(bZ,bM,bU,bJ,bP,bQ,bS,bO,b1,bR,bI,bY){var bW=-1,bH=-1,bK=bJ.endpoints[bS],bT=bK.id,bN=[1,0][bS],bF=[[bM,bU],bJ,bP,bQ,bT],bG=bZ[b1],b0=bK._continuousAnchorEdge?bZ[bK._continuousAnchorEdge]:null;if(b0){var bX=g(b0,function(b2){return b2[4]==bT});if(bX!=-1){b0.splice(bX,1);for(var bV=0;bV<b0.length;bV++){r(bI,b0[bV][1],function(b2){return b2.id==b0[bV][1].id});r(bY,b0[bV][1].endpoints[bS],function(b2){return b2.id==b0[bV][1].endpoints[bS].id})}}}for(var bV=0;bV<bG.length;bV++){if(bS==1&&bG[bV][3]===bQ&&bH==-1){bH=bV}r(bI,bG[bV][1],function(b2){return b2.id==bG[bV][1].id});r(bY,bG[bV][1].endpoints[bS],function(b2){return b2.id==bG[bV][1].endpoints[bS].id})}if(bW!=-1){bG[bW]=bF}else{var bL=bO?bH!=-1?bH:0:bG.length;bG.splice(bL,0,bF)}bK._continuousAnchorEdge=b1};this.redraw=function(bU,bW,bH,bK){if(!ba){var b5=bA[bU]||[],b4=bE[bU]||[],bG=[],b3=[],bI=[];bH=bH||p();bK=bK||{left:0,top:0};if(bW){bW={left:bW.left+bK.left,top:bW.top+bK.top}}X({elId:bU,offset:bW,recalc:false,timestamp:bH});var bP=ai[bU],bL=af[bU],bR={};for(var b1=0;b1<b4.length;b1++){var bM=b4[b1][0],bO=bM.sourceId,bJ=bM.targetId,bN=bM.endpoints[0].anchor.isContinuous,bT=bM.endpoints[1].anchor.isContinuous;if(bN||bT){var b2=bO+"_"+bJ,bZ=bJ+"_"+bO,bY=bR[b2],bS=bM.sourceId==bU?1:0;if(bN&&!bD[bO]){bD[bO]={top:[],right:[],bottom:[],left:[]}}if(bT&&!bD[bJ]){bD[bJ]={top:[],right:[],bottom:[],left:[]}}if(bU!=bJ){X({elId:bJ,timestamp:bH})}if(bU!=bO){X({elId:bO,timestamp:bH})}var bQ=aQ(bJ),bF=aQ(bO);if(bJ==bO&&(bN||bT)){bC(bD[bO],-Math.PI/2,0,bM,false,bJ,0,false,"top",bO,bG,b3)}else{if(!bY){bY=bp(bO,bJ,bF.o,bQ.o);bR[b2]=bY}if(bN){bC(bD[bO],bY.theta,0,bM,false,bJ,0,false,bY.a[0],bO,bG,b3)}if(bT){bC(bD[bJ],bY.theta2,-1,bM,true,bO,1,true,bY.a[1],bJ,bG,b3)}}if(bN){r(bI,bO,function(b6){return b6===bO})}if(bT){r(bI,bJ,function(b6){return b6===bJ})}r(bG,bM,function(b6){return b6.id==bM.id});if((bN&&bS==0)||(bT&&bS==1)){r(b3,bM.endpoints[bS],function(b6){return b6.id==bM.endpoints[bS].id})}}}for(var b1=0;b1<b5.length;b1++){if(b5[b1].connections.length==0&&b5[b1].anchor.isContinuous){if(!bD[bU]){bD[bU]={top:[],right:[],bottom:[],left:[]}}bC(bD[bU],-Math.PI/2,0,{endpoints:[b5[b1],b5[b1]],paint:function(){}},false,bU,0,false,"top",bU,bG,b3);r(bI,bU,function(b6){return b6===bU})}}for(var b1=0;b1<bI.length;b1++){an(bI[b1],bD[bI[b1]])}for(var b1=0;b1<b5.length;b1++){b5[b1].paint({timestamp:bH,offset:bP,dimensions:bL})}for(var b1=0;b1<b3.length;b1++){b3[b1].paint({timestamp:bH,offset:bP,dimensions:bL})}for(var b1=0;b1<b4.length;b1++){var bV=b4[b1][1];if(bV.anchor.constructor==at){bV.paint({elementWithPrecedence:bU});r(bG,b4[b1][0],function(b6){return b6.id==b4[b1][0].id});for(var b0=0;b0<bV.connections.length;b0++){if(bV.connections[b0]!==b4[b1][0]){r(bG,bV.connections[b0],function(b6){return b6.id==bV.connections[b0].id})}}}else{if(bV.anchor.constructor==ab){r(bG,b4[b1][0],function(b6){return b6.id==b4[b1][0].id})}}}var bX=bk[bU];if(bX){bX.paint({timestamp:bH,recalc:false,elId:bU})}for(var b1=0;b1<bG.length;b1++){bG[b1].paint({elId:bU,timestamp:bH,recalc:false})}}};this.rehomeEndpoint=function(bF,bJ){var bG=bA[bF]||[],bH=br.getId(bJ);for(var bI=0;bI<bG.length;bI++){bB.add(bG[bI],bH)}bG.splice(0,bG.length)}};br.anchorManager=new aG();br.continuousAnchorFactory={get:function(bB){var bA=bn[bB.elementId];if(!bA){bA={type:"Continuous",compute:function(bC){return aj[bC.element.id]||[0,0]},getCurrentLocation:function(bC){return aj[bC.id]||[0,0]},getOrientation:function(bC){return aM[bC.id]||[0,0]},isDynamic:true,isContinuous:true};bn[bB.elementId]=bA}return bA}};if(!jsPlumbAdapter.headless){br.dragManager=jsPlumbAdapter.getDragManager(br)}var az=function(bT){var bJ=this,bC=true,bO,bP;bJ.idPrefix="_jsplumb_c_";bJ.defaultLabelLocation=0.5;bJ.defaultOverlayKeys=["Overlays","ConnectionOverlays"];this.parent=bT.parent;x.apply(this,arguments);this.isVisible=function(){return bC};this.setVisible=function(bV){bC=bV;bJ[bV?"showOverlays":"hideOverlays"]();if(bJ.connector&&bJ.connector.canvas){bJ.connector.canvas.style.display=bV?"block":"none"}bJ.repaint()};this.getTypeDescriptor=function(){return"connection"};this.getDefaultType=function(){return{parameters:{},scope:null,detachable:bJ._jsPlumb.Defaults.ConnectionsDetachable,paintStyle:bJ._jsPlumb.Defaults.PaintStyle||n.Defaults.PaintStyle,connector:bJ._jsPlumb.Defaults.Connector||n.Defaults.Connector,hoverPaintStyle:bJ._jsPlumb.Defaults.HoverPaintStyle||n.Defaults.HoverPaintStyle,overlays:bJ._jsPlumb.Defaults.ConnectorOverlays||n.Defaults.ConnectorOverlays}};var bR=this.applyType;this.applyType=function(bV){bR(bV);if(bV.detachable!=null){bJ.setDetachable(bV.detachable)}if(bV.scope){bJ.scope=bV.scope}bJ.setConnector(bV.connector)};bP=bJ.setHover;bJ.setHover=function(bW){var bV=br.ConnectorZIndex||n.Defaults.ConnectorZIndex;if(bV){bJ.connector.setZIndex(bV+(bW?1:0))}bJ.connector.setHover.apply(bJ.connector,arguments);bP.apply(bJ,arguments)};bO=function(bV){if(v==null){bJ.setHover(bV,false)}};this.setConnector=function(bV,bX){if(bJ.connector!=null){a0(bJ.connector.getDisplayElements(),bJ.parent)}var bY={_jsPlumb:bJ._jsPlumb,parent:bT.parent,cssClass:bT.cssClass,container:bT.container,tooltip:bJ.tooltip};if(z(bV)){this.connector=new n.Connectors[Y][bV](bY)}else{if(l(bV)){if(bV.length==1){this.connector=new n.Connectors[Y][bV[0]](bY)}else{this.connector=new n.Connectors[Y][bV[0]](n.extend(bV[1],bY))}}}bJ.canvas=bJ.connector.canvas;D(bJ.connector,bJ,bO);var bW=br.ConnectorZIndex||n.Defaults.ConnectorZIndex;if(bW){bJ.connector.setZIndex(bW)}if(!bX){bJ.repaint()}};this.source=C(bT.source);this.target=C(bT.target);if(bT.sourceEndpoint){this.source=bT.sourceEndpoint.endpointWillMoveTo||bT.sourceEndpoint.getElement()}if(bT.targetEndpoint){this.target=bT.targetEndpoint.getElement()}bJ.previousConnection=bT.previousConnection;this.sourceId=c(this.source,"id");this.targetId=c(this.target,"id");this.scope=bT.scope;this.endpoints=[];this.endpointStyles=[];var bS=function(bW,bV){return(bW)?br.makeAnchor(bW,bV,br):null},bN=function(bV,b1,bW,bY,bZ,bX,b0){var b2;if(bV){bJ.endpoints[b1]=bV;bV.addConnection(bJ)}else{if(!bW.endpoints){bW.endpoints=[null,null]}var b7=bW.endpoints[b1]||bW.endpoint||br.Defaults.Endpoints[b1]||n.Defaults.Endpoints[b1]||br.Defaults.Endpoint||n.Defaults.Endpoint;if(!bW.endpointStyles){bW.endpointStyles=[null,null]}if(!bW.endpointHoverStyles){bW.endpointHoverStyles=[null,null]}var b5=bW.endpointStyles[b1]||bW.endpointStyle||br.Defaults.EndpointStyles[b1]||n.Defaults.EndpointStyles[b1]||br.Defaults.EndpointStyle||n.Defaults.EndpointStyle;if(b5.fillStyle==null&&bX!=null){b5.fillStyle=bX.strokeStyle}if(b5.outlineColor==null&&bX!=null){b5.outlineColor=bX.outlineColor}if(b5.outlineWidth==null&&bX!=null){b5.outlineWidth=bX.outlineWidth}var b4=bW.endpointHoverStyles[b1]||bW.endpointHoverStyle||br.Defaults.EndpointHoverStyles[b1]||n.Defaults.EndpointHoverStyles[b1]||br.Defaults.EndpointHoverStyle||n.Defaults.EndpointHoverStyle;if(b0!=null){if(b4==null){b4={}}if(b4.fillStyle==null){b4.fillStyle=b0.strokeStyle}}var b3=bW.anchors?bW.anchors[b1]:bW.anchor?bW.anchor:bS(br.Defaults.Anchors[b1],bZ)||bS(n.Defaults.Anchors[b1],bZ)||bS(br.Defaults.Anchor,bZ)||bS(n.Defaults.Anchor,bZ),b6=bW.uuids?bW.uuids[b1]:null;b2=aH({paintStyle:b5,hoverPaintStyle:b4,endpoint:b7,connections:[bJ],uuid:b6,anchor:b3,source:bY,scope:bW.scope,container:bW.container,reattach:bW.reattach,detachable:bW.detachable});bJ.endpoints[b1]=b2;if(bW.drawEndpoints===false){b2.setVisible(false,true,true)}}return b2};var bL=bN(bT.sourceEndpoint,0,bT,bJ.source,bJ.sourceId,bT.paintStyle,bT.hoverPaintStyle);if(bL){W(aW,this.sourceId,bL)}var bK=bN(bT.targetEndpoint,1,bT,bJ.target,bJ.targetId,bT.paintStyle,bT.hoverPaintStyle);if(bK){W(aW,this.targetId,bK)}if(!this.scope){this.scope=this.endpoints[0].scope}if(bT.deleteEndpointsOnDetach){bJ.endpointsToDeleteOnDetach=[bL,bK]}bJ.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||bT.connector||br.Defaults.Connector||n.Defaults.Connector,true);this.setPaintStyle(this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||bT.paintStyle||br.Defaults.PaintStyle||n.Defaults.PaintStyle,true);this.setHoverPaintStyle(this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||bT.hoverPaintStyle||br.Defaults.HoverPaintStyle||n.Defaults.HoverPaintStyle,true);this.paintStyleInUse=this.getPaintStyle();X({elId:this.sourceId});X({elId:this.targetId});var bE=ai[this.sourceId],bD=af[this.sourceId],bA=ai[this.targetId],bH=af[this.targetId],bI=p(),bM=this.endpoints[0].anchor.compute({xy:[bE.left,bE.top],wh:bD,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[bA.left,bA.top],twh:bH,tElement:this.endpoints[1],timestamp:bI});this.endpoints[0].paint({anchorLoc:bM,timestamp:bI});bM=this.endpoints[1].anchor.compute({xy:[bA.left,bA.top],wh:bH,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[bE.left,bE.top],twh:bD,tElement:this.endpoints[0],timestamp:bI});this.endpoints[1].paint({anchorLoc:bM,timestamp:bI});var bB=br.Defaults.ConnectionsDetachable;if(bT.detachable===false){bB=false}if(bJ.endpoints[0].connectionsDetachable===false){bB=false}if(bJ.endpoints[1].connectionsDetachable===false){bB=false}this.isDetachable=function(){return bB===true};this.setDetachable=function(bV){bB=bV===true};var bG=bT.cost||bJ.endpoints[0].getConnectionCost();bJ.getCost=function(){return bG};bJ.setCost=function(bV){bG=bV};var bF=!(bT.bidirectional===false);if(bT.bidirectional==null){bF=bJ.endpoints[0].areConnectionsBidirectional()}bJ.isBidirectional=function(){return bF};var bU=n.extend({},this.endpoints[0].getParameters());n.extend(bU,this.endpoints[1].getParameters());n.extend(bU,bJ.getParameters());bJ.setParameters(bU);this.getAttachedElements=function(){return bJ.endpoints};this.moveParent=function(bY){var bX=n.CurrentLibrary,bW=bX.getParent(bJ.connector.canvas);if(bJ.connector.bgCanvas){bX.removeElement(bJ.connector.bgCanvas,bW);bX.appendElement(bJ.connector.bgCanvas,bY)}bX.removeElement(bJ.connector.canvas,bW);bX.appendElement(bJ.connector.canvas,bY);for(var bV=0;bV<bJ.overlays.length;bV++){if(bJ.overlays[bV].isAppendedAtTopLevel){bX.removeElement(bJ.overlays[bV].canvas,bW);bX.appendElement(bJ.overlays[bV].canvas,bY);if(bJ.overlays[bV].reattachListeners){bJ.overlays[bV].reattachListeners(bJ.connector)}}}if(bJ.connector.reattachListeners){bJ.connector.reattachListeners()}};this.paint=function(cc){if(bC){cc=cc||{};var b3=cc.elId,b4=cc.ui,b1=cc.recalc,bW=cc.timestamp,b5=false,cb=b5?this.sourceId:this.targetId,b0=b5?this.targetId:this.sourceId,bX=b5?0:1,cd=b5?1:0;var ce=X({elId:b3,offset:b4,recalc:b1,timestamp:bW}),b2=X({elId:cb,timestamp:bW});var b7=this.endpoints[cd],bV=this.endpoints[bX],bZ=b7.anchor.getCurrentLocation(b7),ca=bV.anchor.getCurrentLocation(bV);var bY=0;for(var b9=0;b9<bJ.overlays.length;b9++){var b6=bJ.overlays[b9];if(b6.isVisible()){bY=Math.max(bY,b6.computeMaxSize())}}var b8=this.connector.compute(bZ,ca,this.endpoints[cd],this.endpoints[bX],this.endpoints[cd].anchor,this.endpoints[bX].anchor,bJ.paintStyleInUse.lineWidth,bY,ce,b2);bJ.connector.paint(b8,bJ.paintStyleInUse);for(var b9=0;b9<bJ.overlays.length;b9++){var b6=bJ.overlays[b9];if(b6.isVisible){bJ.overlayPlacements[b9]=b6.draw(bJ.connector,bJ.paintStyleInUse,b8)}}}};this.repaint=function(bW){bW=bW||{};var bV=!(bW.recalc===false);this.paint({elId:this.sourceId,recalc:bV,timestamp:bW.timestamp})};var bQ=bT.type||bJ.endpoints[0].connectionType||bJ.endpoints[1].connectionType;if(bQ){bJ.setType(bQ)}};var bh=function(bB){var bA=false;return{drag:function(){if(bA){bA=false;return true}var bC=n.CurrentLibrary.getUIPosition(arguments),bD=bB.element;if(bD){n.CurrentLibrary.setOffset(bD,bC);be(C(bD),bC)}},stopDrag:function(){bA=true}}};var av=function(bE,bD,bF,bC,bA){var bB=new a4({reference:bD,referenceCanvas:bC});return aH({paintStyle:bE,endpoint:bF,anchor:bB,source:bA,scope:"__floating"})};var S=function(bC,bA){var bE=document.createElement("div");bE.style.position="absolute";var bB=C(bE);aY(bE,bA);var bD=H(bB);X({elId:bD});bC.id=bD;bC.element=bB};var ag=function(b6){var bT=this;bT.idPrefix="_jsplumb_e_";bT.defaultLabelLocation=[0.5,0.5];bT.defaultOverlayKeys=["Overlays","EndpointOverlays"];this.parent=b6.parent;x.apply(this,arguments);b6=b6||{};this.getTypeDescriptor=function(){return"endpoint"};this.getDefaultType=function(){return{parameters:{},scope:null,maxConnections:bT._jsPlumb.Defaults.MaxConnections,paintStyle:bT._jsPlumb.Defaults.EndpointStyle||n.Defaults.EndpointStyle,endpoint:bT._jsPlumb.Defaults.Endpoint||n.Defaults.Endpoint,hoverPaintStyle:bT._jsPlumb.Defaults.EndpointHoverStyle||n.Defaults.EndpointHoverStyle,overlays:bT._jsPlumb.Defaults.EndpointOverlays||n.Defaults.EndpointOverlays,connectorStyle:b6.connectorStyle,connectorHoverStyle:b6.connectorHoverStyle,connectorClass:b6.connectorClass,connectorHoverClass:b6.connectorHoverClass,connectorOverlays:b6.connectorOverlays,connector:b6.connector,connectorTooltip:b6.connectorTooltip}};var b4=this.applyType;this.applyType=function(b8){b4(b8);if(b8.maxConnections!=null){bZ=b8.maxConnections}if(b8.scope){bT.scope=b8.scope}bT.connectorStyle=b8.connectorStyle;bT.connectorHoverStyle=b8.connectorHoverStyle;bT.connectorOverlays=b8.connectorOverlays;bT.connector=b8.connector;bT.connectorTooltip=b8.connectorTooltip;bT.connectionType=b8.connectionType;bT.connectorClass=b8.connectorClass;bT.connectorHoverClass=b8.connectorHoverClass};var bF=true,bD=!(b6.enabled===false);this.isVisible=function(){return bF};this.setVisible=function(b9,cc,b8){bF=b9;if(bT.canvas){bT.canvas.style.display=b9?"block":"none"}bT[b9?"showOverlays":"hideOverlays"]();if(!cc){for(var cb=0;cb<bT.connections.length;cb++){bT.connections[cb].setVisible(b9);if(!b8){var ca=bT===bT.connections[cb].endpoints[0]?1:0;if(bT.connections[cb].endpoints[ca].connections.length==1){bT.connections[cb].endpoints[ca].setVisible(b9,true,true)}}}}};this.isEnabled=function(){return bD};this.setEnabled=function(b8){bD=b8};var bS=b6.source,bM=b6.uuid,b3=null,bH=null;if(bM){aX[bM]=bT}var bK=c(bS,"id");this.elementId=bK;this.element=bS;var bC=b6.connectionCost;this.getConnectionCost=function(){return bC};this.setConnectionCost=function(b8){bC=b8};var b2=b6.connectionsBidirectional===false?false:true;this.areConnectionsBidirectional=function(){return b2};this.setConnectionsBidirectional=function(b8){b2=b8};bT.anchor=b6.anchor?br.makeAnchor(b6.anchor,bK,br):b6.anchors?br.makeAnchor(b6.anchors,bK,br):br.makeAnchor("TopCenter",bK,br);if(!b6._transient){br.anchorManager.add(bT,bK)}var bQ=null,bV=null;this.setEndpoint=function(b8){var b9={_jsPlumb:bT._jsPlumb,parent:b6.parent,container:b6.container,tooltip:b6.tooltip,connectorTooltip:b6.connectorTooltip,endpoint:bT};if(z(b8)){bQ=new n.Endpoints[Y][b8](b9)}else{if(l(b8)){b9=n.extend(b8[1],b9);bQ=new n.Endpoints[Y][b8[0]](b9)}else{bQ=b8.clone()}}var ca=n.extend({},b9);bQ.clone=function(){var cb=new Object();bQ.constructor.apply(cb,[ca]);return cb};bT.endpoint=bQ;bT.type=bT.endpoint.type};this.setEndpoint(b6.endpoint||br.Defaults.Endpoint||n.Defaults.Endpoint||"Dot");bV=bQ;var bR=bT.setHover;bT.setHover=function(){bT.endpoint.setHover.apply(bT.endpoint,arguments);bR.apply(bT,arguments)};var b7=function(b8){if(bT.connections.length>0){bT.connections[0].setHover(b8,false)}else{bT.setHover(b8)}};D(bT.endpoint,bT,b7);this.setPaintStyle(b6.paintStyle||b6.style||br.Defaults.EndpointStyle||n.Defaults.EndpointStyle,true);this.setHoverPaintStyle(b6.hoverPaintStyle||br.Defaults.EndpointHoverStyle||n.Defaults.EndpointHoverStyle,true);this.paintStyleInUse=this.getPaintStyle();var bO=this.getPaintStyle();this.connectorStyle=b6.connectorStyle;this.connectorHoverStyle=b6.connectorHoverStyle;this.connectorOverlays=b6.connectorOverlays;this.connector=b6.connector;this.connectorTooltip=b6.connectorTooltip;this.connectorClass=b6.connectorClass;this.connectorHoverClass=b6.connectorHoverClass;this.isSource=b6.isSource||false;this.isTarget=b6.isTarget||false;var bZ=b6.maxConnections||br.Defaults.MaxConnections;this.getAttachedElements=function(){return bT.connections};this.canvas=this.endpoint.canvas;this.connections=b6.connections||[];this.scope=b6.scope||R;this.connectionType=b6.connectionType;this.timestamp=null;bT.isReattach=b6.reattach||false;bT.connectionsDetachable=br.Defaults.ConnectionsDetachable;if(b6.connectionsDetachable===false||b6.detachable===false){bT.connectionsDetachable=false}var bN=b6.dragAllowedWhenFull||true;if(b6.onMaxConnections){bT.bind("maxConnections",b6.onMaxConnections)}this.computeAnchor=function(b8){return bT.anchor.compute(b8)};this.addConnection=function(b8){bT.connections.push(b8)};this.detach=function(b9,ce,ca,ch,b8){var cg=g(bT.connections,function(cj){return cj.id==b9.id}),cf=false;ch=(ch!==false);if(cg>=0){if(ca||b9._forceDetach||b9.isDetachable()||b9.isDetachAllowed(b9)){var ci=b9.endpoints[0]==bT?b9.endpoints[1]:b9.endpoints[0];if(ca||b9._forceDetach||(bT.isDetachAllowed(b9))){bT.connections.splice(cg,1);if(!ce){ci.detach(b9,true,ca);if(b9.endpointsToDeleteOnDetach){for(var cd=0;cd<b9.endpointsToDeleteOnDetach.length;cd++){var cb=b9.endpointsToDeleteOnDetach[cd];if(cb&&cb.connections.length==0){br.deleteEndpoint(cb)}}}}a0(b9.connector.getDisplayElements(),b9.parent);A(a1[b9.scope],function(cj){return cj.id==b9.id});cf=true;var cc=(!ce&&ch);bb(b9,cc,b8)}}}return cf};this.detachAll=function(b9,b8){while(bT.connections.length>0){bT.detach(bT.connections[0],false,true,b9,b8)}};this.detachFrom=function(cb,ca,b8){var cc=[];for(var b9=0;b9<bT.connections.length;b9++){if(bT.connections[b9].endpoints[1]==cb||bT.connections[b9].endpoints[0]==cb){cc.push(bT.connections[b9])}}for(var b9=0;b9<cc.length;b9++){if(bT.detach(cc[b9],false,true,ca,b8)){cc[b9].setHover(false,false)}}};this.detachFromConnection=function(b9){var b8=g(bT.connections,function(ca){return ca.id==b9.id});if(b8>=0){bT.connections.splice(b8,1)}};this.getElement=function(){return bS};this.setElement=function(cb,b8){var cd=H(cb);A(aW[bT.elementId],function(ce){return ce.id==bT.id});bS=C(cb);bK=H(bS);bT.elementId=bK;var cc=ay({source:cd,container:b8}),ca=bE.getParent(bT.canvas);bE.removeElement(bT.canvas,ca);bE.appendElement(bT.canvas,cc);for(var b9=0;b9<bT.connections.length;b9++){bT.connections[b9].moveParent(cc);bT.connections[b9].sourceId=bK;bT.connections[b9].source=bS}W(aW,cd,bT)};this.getUuid=function(){return bM};this.makeInPlaceCopy=function(){var ca=bT.anchor.getCurrentLocation(bT),b9=bT.anchor.getOrientation(bT),b8={compute:function(){return[ca[0],ca[1]]},getCurrentLocation:function(){return[ca[0],ca[1]]},getOrientation:function(){return b9}};return aH({anchor:b8,source:bS,paintStyle:this.getPaintStyle(),endpoint:bQ,_transient:true,scope:bT.scope})};this.isConnectedTo=function(ca){var b9=false;if(ca){for(var b8=0;b8<bT.connections.length;b8++){if(bT.connections[b8].endpoints[1]==ca){b9=true;break}}}return b9};this.isFloating=function(){return b3!=null};this.connectorSelector=function(){var b8=bT.connections[0];if(bT.isTarget&&b8){return b8}else{return(bT.connections.length<bZ)||bZ==-1?null:b8}};this.isFull=function(){return !(bT.isFloating()||bZ<1||bT.connections.length<bZ)};this.setDragAllowedWhenFull=function(b8){bN=b8};this.setStyle=bT.setPaintStyle;this.equals=function(b8){return this.anchor.equals(b8.anchor)};var bP=function(b9){var b8=0;if(b9!=null){for(var ca=0;ca<bT.connections.length;ca++){if(bT.connections[ca].sourceId==b9||bT.connections[ca].targetId==b9){b8=ca;break}}}return bT.connections[b8]};this.paint=function(cb){cb=cb||{};var ch=cb.timestamp,cg=!(cb.recalc===false);if(!ch||bT.timestamp!==ch){X({elId:bK,timestamp:ch,recalc:cg});var cn=cb.offset||ai[bK];if(cn){var ce=cb.anchorPoint,cc=cb.connectorPaintStyle;if(ce==null){var b8=cb.dimensions||af[bK];if(cn==null||b8==null){X({elId:bK,timestamp:ch});cn=ai[bK];b8=af[bK]}var ca={xy:[cn.left,cn.top],wh:b8,element:bT,timestamp:ch};if(cg&&bT.anchor.isDynamic&&bT.connections.length>0){var ck=bP(cb.elementWithPrecedence),cm=ck.endpoints[0]==bT?1:0,cd=cm==0?ck.sourceId:ck.targetId,cj=ai[cd],cl=af[cd];ca.txy=[cj.left,cj.top];ca.twh=cl;ca.tElement=ck.endpoints[cm]}ce=bT.anchor.compute(ca)}var ci=bQ.compute(ce,bT.anchor.getOrientation(bT),bT.paintStyleInUse,cc||bT.paintStyleInUse);bQ.paint(ci,bT.paintStyleInUse,bT.anchor);bT.timestamp=ch;for(var cf=0;cf<bT.overlays.length;cf++){var b9=bT.overlays[cf];if(b9.isVisible){bT.overlayPlacements[cf]=b9.draw(bT.endpoint,bT.paintStyleInUse,ci)}}}}};this.repaint=this.paint;this.removeConnection=this.detach;if(n.CurrentLibrary.isDragSupported(bS)){var bY={id:null,element:null},bX=null,bB=false,bG=null,bA=bh(bY);var bI=function(){bX=bT.connectorSelector();var b8=true;if(!bT.isEnabled()){b8=false}if(bX==null&&!b6.isSource){b8=false}if(b6.isSource&&bT.isFull()&&!bN){b8=false}if(bX!=null&&!bX.isDetachable()){b8=false}if(b8===false){if(n.CurrentLibrary.stopDrag){n.CurrentLibrary.stopDrag()}bA.stopDrag();return false}if(bX&&!bT.isFull()&&b6.isSource){bX=null}X({elId:bK});bH=bT.makeInPlaceCopy();bH.paint();S(bY,bT.parent);var ce=C(bH.canvas),cc=n.CurrentLibrary.getOffset(ce),b9=bs([cc.left,cc.top],bH.canvas);n.CurrentLibrary.setOffset(bY.element,{left:b9[0],top:b9[1]});if(bT.parentAnchor){bT.anchor=br.makeAnchor(bT.parentAnchor,bT.elementId,br)}d(C(bT.canvas),"dragId",bY.id);d(C(bT.canvas),"elId",bK);if(b6.proxy){bT.setPaintStyle(b6.proxy.paintStyle)}b3=av(bT.getPaintStyle(),bT.anchor,bQ,bT.canvas,bY.element);if(bX==null){bT.anchor.locked=true;bT.setHover(false,false);bX=ae({sourceEndpoint:bT,targetEndpoint:b3,source:bT.endpointWillMoveTo||C(bS),target:bY.element,anchors:[bT.anchor,b3.anchor],paintStyle:b6.connectorStyle,hoverPaintStyle:b6.connectorHoverStyle,connector:b6.connector,overlays:b6.connectorOverlays,type:bT.connectionType,cssClass:bT.connectorClass,hoverClass:bT.connectorHoverClass})}else{bB=true;bX.connector.setHover(false,false);bJ(C(bH.canvas),false,true);var cb=bX.endpoints[0].id==bT.id?0:1;bX.floatingAnchorIndex=cb;bT.detachFromConnection(bX);var cf=C(bT.canvas),cd=n.CurrentLibrary.getDragScope(cf);d(cf,"originalScope",cd);var ca=n.CurrentLibrary.getDropScope(cf);n.CurrentLibrary.setDragScope(cf,ca);if(cb==0){bG=[bX.source,bX.sourceId,b1,cd];bX.source=bY.element;bX.sourceId=bY.id}else{bG=[bX.target,bX.targetId,b1,cd];bX.target=bY.element;bX.targetId=bY.id}bX.endpoints[cb==0?1:0].anchor.locked=true;bX.suspendedEndpoint=bX.endpoints[cb];bX.suspendedEndpoint.setHover(false);bX.endpoints[cb]=b3;a9(bX)}bk[bY.id]=bX;b3.addConnection(bX);W(aW,bY.id,b3);br.currentlyDragging=true};var bE=n.CurrentLibrary,b0=b6.dragOptions||{},bU=n.extend({},bE.defaultDragOptions),bW=bE.dragEvents.start,b5=bE.dragEvents.stop,bL=bE.dragEvents.drag;b0=n.extend(bU,b0);b0.scope=b0.scope||bT.scope;b0[bW]=ao(b0[bW],bI);b0[bL]=ao(b0[bL],bA.drag);b0[b5]=ao(b0[b5],function(){var b9=bE.getDropEvent(arguments);br.currentlyDragging=false;A(aW[bY.id],function(ca){return ca.id==b3.id});a0([bY.element[0],b3.canvas],bS);aw(bH.canvas,bS);br.anchorManager.clearFor(bY.id);var b8=bX.floatingAnchorIndex==null?1:bX.floatingAnchorIndex;bX.endpoints[b8==0?1:0].anchor.locked=false;bT.setPaintStyle(bO);if(bX.endpoints[b8]==b3){if(bB&&bX.suspendedEndpoint){if(b8==0){bX.source=bG[0];bX.sourceId=bG[1]}else{bX.target=bG[0];bX.targetId=bG[1]}n.CurrentLibrary.setDragScope(bG[2],bG[3]);bX.endpoints[b8]=bX.suspendedEndpoint;if(bT.isReattach||bX._forceDetach||!bX.endpoints[b8==0?1:0].detach(bX,false,false,true,b9)){bX.setHover(false);bX.floatingAnchorIndex=null;bX.suspendedEndpoint.addConnection(bX);br.repaint(bG[1])}bX._forceDetach=null}else{a0(bX.connector.getDisplayElements(),bT.parent);bT.detachFromConnection(bX)}}bT.anchor.locked=false;bT.paint({recalc:false});bX.setHover(false,false);aU(bX);bX=null;bH=null;delete aW[b3.elementId];b3.anchor=null;b3=null;br.currentlyDragging=false});var b1=C(bT.canvas);n.CurrentLibrary.initDraggable(b1,b0,true)}var bJ=function(ca,cf,cd,cg){if((b6.isTarget||cf)&&n.CurrentLibrary.isDropSupported(bS)){var cb=b6.dropOptions||br.Defaults.DropOptions||n.Defaults.DropOptions;cb=n.extend({},cb);cb.scope=cb.scope||bT.scope;var b9=n.CurrentLibrary.dragEvents.drop,ce=n.CurrentLibrary.dragEvents.over,b8=n.CurrentLibrary.dragEvents.out,cc=function(){var ch=n.CurrentLibrary.getDropEvent(arguments),cu=C(n.CurrentLibrary.getDragObject(arguments)),ci=c(cu,"dragId"),cl=c(cu,"elId"),ct=c(cu,"originalScope"),co=bk[ci];if(co!=null){var cq=co.floatingAnchorIndex==null?1:co.floatingAnchorIndex,cr=cq==0?1:0;if(ct){n.CurrentLibrary.setDragScope(cu,ct)}var cs=cg!=null?cg.isEnabled():true;if(bT.isFull()){bT.fire("maxConnections",{endpoint:bT,connection:co,maxConnections:bZ},ch)}if(!bT.isFull()&&!(cq==0&&!bT.isSource)&&!(cq==1&&!bT.isTarget)&&cs){var cm=true;if(co.suspendedEndpoint&&co.suspendedEndpoint.id!=bT.id){if(cq==0){co.source=co.suspendedEndpoint.element;co.sourceId=co.suspendedEndpoint.elementId}else{co.target=co.suspendedEndpoint.element;co.targetId=co.suspendedEndpoint.elementId}if(!co.isDetachAllowed(co)||!co.endpoints[cq].isDetachAllowed(co)||!co.suspendedEndpoint.isDetachAllowed(co)||!br.checkCondition("beforeDetach",co)){cm=false}}if(cq==0){co.source=bT.element;co.sourceId=bT.elementId}else{co.target=bT.element;co.targetId=bT.elementId}cm=cm&&bT.isDropAllowed(co.sourceId,co.targetId,co.scope,co,bT);if(cm){co.endpoints[cq].detachFromConnection(co);if(co.suspendedEndpoint){co.suspendedEndpoint.detachFromConnection(co)}co.endpoints[cq]=bT;bT.addConnection(co);var ck=bT.getParameters();for(var cp in ck){co.setParameter(cp,ck[cp])}if(!co.suspendedEndpoint){if(ck.draggable){n.CurrentLibrary.initDraggable(bT.element,b0,true)}}else{var cn=co.suspendedEndpoint.getElement(),cj=co.suspendedEndpoint.elementId;bb({source:cq==0?cn:co.source,target:cq==1?cn:co.target,sourceId:cq==0?cj:co.sourceId,targetId:cq==1?cj:co.targetId,sourceEndpoint:cq==0?co.suspendedEndpoint:co.endpoints[0],targetEndpoint:cq==1?co.suspendedEndpoint:co.endpoints[1],connection:co},true,ch)}by(co,null,ch)}else{if(co.suspendedEndpoint){co.endpoints[cq]=co.suspendedEndpoint;co.setHover(false);co._forceDetach=true;if(cq==0){co.source=co.suspendedEndpoint.element;co.sourceId=co.suspendedEndpoint.elementId}else{co.target=co.suspendedEndpoint.element;co.targetId=co.suspendedEndpoint.elementId}co.suspendedEndpoint.addConnection(co);co.endpoints[0].repaint();co.repaint();br.repaint(co.source.elementId);co._forceDetach=false}}co.floatingAnchorIndex=null}br.currentlyDragging=false;delete bk[ci]}};cb[b9]=ao(cb[b9],cc);cb[ce]=ao(cb[ce],function(){if(bT.isTarget){var ci=n.CurrentLibrary.getDragObject(arguments),ck=c(C(ci),"dragId"),cj=bk[ck];if(cj!=null){var ch=cj.floatingAnchorIndex==null?1:cj.floatingAnchorIndex;cj.endpoints[ch].anchor.over(bT.anchor)}}});cb[b8]=ao(cb[b8],function(){if(bT.isTarget){var ci=n.CurrentLibrary.getDragObject(arguments),ck=c(C(ci),"dragId"),cj=bk[ck];if(cj!=null){var ch=cj.floatingAnchorIndex==null?1:cj.floatingAnchorIndex;cj.endpoints[ch].anchor.out()}}});n.CurrentLibrary.initDroppable(ca,cb,true,cd)}};bJ(C(bT.canvas),true,!(b6._transient||bT.anchor.isFloating),bT);if(b6.type){bT.setType(b6.type)}return bT}};var n=new w();if(typeof window!="undefined"){window.jsPlumb=n}n.getInstance=function(I){var H=new w(I);H.init();return H};var q=function(H,M,J,I,L,K){return function(O){O=O||{};var N=O.jsPlumbInstance.makeAnchor([H,M,J,I,0,0],O.elementId,O.jsPlumbInstance);N.type=L;if(K){K(N,O)}return N}};n.Anchors.TopCenter=q(0.5,0,0,-1,"TopCenter");n.Anchors.BottomCenter=q(0.5,1,0,1,"BottomCenter");n.Anchors.LeftMiddle=q(0,0.5,-1,0,"LeftMiddle");n.Anchors.RightMiddle=q(1,0.5,1,0,"RightMiddle");n.Anchors.Center=q(0.5,0.5,0,0,"Center");n.Anchors.TopRight=q(1,0,0,-1,"TopRight");n.Anchors.BottomRight=q(1,1,0,1,"BottomRight");n.Anchors.TopLeft=q(0,0,0,-1,"TopLeft");n.Anchors.BottomLeft=q(0,1,0,1,"BottomLeft");n.Defaults.DynamicAnchors=function(H){return H.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],H.elementId,H.jsPlumbInstance)};n.Anchors.AutoDefault=function(I){var H=I.jsPlumbInstance.makeDynamicAnchor(n.Defaults.DynamicAnchors(I));H.type="AutoDefault";return H};n.Anchors.Assign=q(0,0,0,0,"Assign",function(I,J){var H=J.position||"Fixed";I.positionFinder=H.constructor==String?J.jsPlumbInstance.AnchorPositionFinders[H]:H;I.constructorParams=J});n.Anchors.Continuous=function(H){return H.jsPlumbInstance.continuousAnchorFactory.get(H)};n.AnchorPositionFinders={Fixed:function(K,H,J,I){return[(K.left-H.left)/J[0],(K.top-H.top)/J[1]]},Grid:function(H,Q,L,I){var P=H.left-Q.left,O=H.top-Q.top,N=L[0]/(I.grid[0]),M=L[1]/(I.grid[1]),K=Math.floor(P/N),J=Math.floor(O/M);return[((K*N)+(N/2))/L[0],((J*M)+(M/2))/L[1]]}}})();(function(){jsPlumb.DOMElementComponent=function(d){jsPlumb.jsPlumbUIComponent.apply(this,arguments);this.mousemove=this.dblclick=this.click=this.mousedown=this.mouseup=function(f){}};jsPlumb.Connectors.Straight=function(){this.type="Straight";var s=this,k=null,f,l,q,o,m,g,r,i,h,e,d,p,n;this.compute=function(B,K,t,A,G,u,E,z){var J=Math.abs(B[0]-K[0]),D=Math.abs(B[1]-K[1]),C=0.45*J,v=0.45*D;J*=1.9;D*=1.9;var H=Math.min(B[0],K[0])-C;var F=Math.min(B[1],K[1])-v;var I=Math.max(2*E,z);if(J<I){J=I;H=B[0]+((K[0]-B[0])/2)-(I/2);C=(J-Math.abs(B[0]-K[0]))/2}if(D<I){D=I;F=B[1]+((K[1]-B[1])/2)-(I/2);v=(D-Math.abs(B[1]-K[1]))/2}i=B[0]<K[0]?C:J-C;h=B[1]<K[1]?v:D-v;e=B[0]<K[0]?J-C:C;d=B[1]<K[1]?D-v:v;k=[H,F,J,D,i,h,e,d];o=e-i,m=d-h;f=jsPlumbUtil.gradient({x:i,y:h},{x:e,y:d}),l=-1/f;q=-1*((f*i)-h);g=Math.atan(f);r=Math.atan(l);n=Math.sqrt((o*o)+(m*m));return k};this.pointOnPath=function(u,v){if(u==0&&!v){return{x:i,y:h}}else{if(u==1&&!v){return{x:e,y:d}}else{var t=v?u>0?u:n+u:u*n;return jsPlumbUtil.pointOnLine({x:i,y:h},{x:e,y:d},t)}}};this.gradientAtPoint=function(t){return f};this.pointAlongPathFrom=function(t,x,w){var v=s.pointOnPath(t,w),u=t==1?{x:i+((e-i)*10),y:h+((h-d)*10)}:{x:e,y:d};return jsPlumbUtil.pointOnLine(v,u,x)}};jsPlumb.Connectors.Bezier=function(w){var q=this;w=w||{};this.majorAnchor=w.curviness||150;this.minorAnchor=10;var u=null;this.type="Bezier";this._findControlPoint=function(I,x,D,y,B,G,z){var F=G.getOrientation(y),H=z.getOrientation(B),C=F[0]!=H[0]||F[1]==H[1],A=[],J=q.majorAnchor,E=q.minorAnchor;if(!C){if(F[0]==0){A.push(x[0]<D[0]?I[0]+E:I[0]-E)}else{A.push(I[0]-(J*F[0]))}if(F[1]==0){A.push(x[1]<D[1]?I[1]+E:I[1]-E)}else{A.push(I[1]+(J*H[1]))}}else{if(H[0]==0){A.push(D[0]<x[0]?I[0]+E:I[0]-E)}else{A.push(I[0]+(J*H[0]))}if(H[1]==0){A.push(D[1]<x[1]?I[1]+E:I[1]-E)}else{A.push(I[1]+(J*F[1]))}}return A};var r,m,g,p,o,g,f,t,s,v,e,i,h,l,k;this.compute=function(T,A,N,B,R,y,x,M){x=x||0;v=Math.abs(T[0]-A[0])+x;e=Math.abs(T[1]-A[1])+x;t=Math.min(T[0],A[0])-(x/2);s=Math.min(T[1],A[1])-(x/2);g=T[0]<A[0]?v-(x/2):(x/2);f=T[1]<A[1]?e-(x/2):(x/2);p=T[0]<A[0]?(x/2):v-(x/2);o=T[1]<A[1]?(x/2):e-(x/2);r=q._findControlPoint([g,f],T,A,N,B,R,y);m=q._findControlPoint([p,o],A,T,B,N,y,R);var L=Math.min(g,p),K=Math.min(r[0],m[0]),G=Math.min(L,K),S=Math.max(g,p),P=Math.max(r[0],m[0]),D=Math.max(S,P);if(D>v){v=D}if(G<0){t+=G;var I=Math.abs(G);v+=I;r[0]+=I;g+=I;p+=I;m[0]+=I}var Q=Math.min(f,o),O=Math.min(r[1],m[1]),C=Math.min(Q,O),H=Math.max(f,o),F=Math.max(r[1],m[1]),z=Math.max(H,F);if(z>e){e=z}if(C<0){s+=C;var E=Math.abs(C);e+=E;r[1]+=E;f+=E;o+=E;m[1]+=E}if(M&&v<M){var J=(M-v)/2;v=M;t-=J;g=g+J;p=p+J;r[0]=r[0]+J;m[0]=m[0]+J}if(M&&e<M){var J=(M-e)/2;e=M;s-=J;f=f+J;o=o+J;r[1]=r[1]+J;m[1]=m[1]+J}u=[t,s,v,e,g,f,p,o,r[0],r[1],m[0],m[1]];return u};var d=function(){return[{x:g,y:f},{x:r[0],y:r[1]},{x:m[0],y:m[1]},{x:p,y:o}]};var n=function(y,x,z){if(z){x=jsBezier.locationAlongCurveFrom(y,x>0?0:1,x)}return x};this.pointOnPath=function(x,z){var y=d();x=n(y,x,z);return jsBezier.pointOnCurve(y,x)};this.gradientAtPoint=function(x,z){var y=d();x=n(y,x,z);return jsBezier.gradientAtPoint(y,x)};this.pointAlongPathFrom=function(x,A,z){var y=d();x=n(y,x,z);return jsBezier.pointAlongCurveFrom(y,x,A)}};jsPlumb.Connectors.Flowchart=function(z){this.type="Flowchart";z=z||{};var r=this,e=z.stub||z.minStubLength||30,i=jsPlumbUtil.isArray(e)?e[0]:e,o=jsPlumbUtil.isArray(e)?e[1]:e,t=z.gap||0,u=[],m=0,g=[],q=[],v=[],s,p,y=-Infinity,w=-Infinity,A=Infinity,x=Infinity,d=z.grid,f=function(G,C){var F=G%C,D=Math.floor(G/C),E=F>(C/2)?1:0;return(D+E)*C},n=function(C,F,E,D){return[E||d==null?C:f(C,d[0]),D||d==null?F:f(F,d[1])]},B=function(D,C,H,G){var F=0;for(var E=0;E<u.length;E++){q[E]=u[E][5]/m;g[E]=[F,(F+=(u[E][5]/m))]}},l=function(){v.push(u.length);for(var C=0;C<u.length;C++){v.push(u[C][0]);v.push(u[C][1])}},k=function(L,I,K,J,H,G){var D=u.length==0?K:u[u.length-1][0],C=u.length==0?J:u[u.length-1][1],E=L==D?Infinity:0,F=Math.abs(L==D?I-C:L-D);u.push([L,I,D,C,E,F]);m+=F;y=Math.max(y,L);w=Math.max(w,I);A=Math.min(A,L);x=Math.min(x,I)},h=function(E,G){if(G){E=E>0?E/m:(m+E)/m}var C=g.length-1,D=1;for(var F=0;F<g.length;F++){if(g[F][1]>=E){C=F;D=(E-g[F][0])/q[F];break}}return{segment:u[C],proportion:D,index:C}};this.compute=function(Z,an,C,T,ay,N,X,S,at,ap){u=[];g=[];m=0;q=[];y=w=-Infinity;A=x=Infinity;s=an[0]<Z[0];p=an[1]<Z[1];var ad=X||1,H=(ad/2)+(i+o),E=(ad/2)+(o+i),G=(ad/2)+(i+o),D=(ad/2)+(o+i),Q=ay.orientation||ay.getOrientation(C),az=N.orientation||N.getOrientation(T),am=s?an[0]:Z[0],al=p?an[1]:Z[1],ao=Math.abs(an[0]-Z[0])+H+E,ax=Math.abs(an[1]-Z[1])+G+D;if(Q[0]==0&&Q[1]==0||az[0]==0&&az[1]==0){var af=ao>ax?0:1,ah=[1,0][af];Q=[];az=[];Q[af]=Z[af]>an[af]?-1:1;az[af]=Z[af]>an[af]?1:-1;Q[ah]=0;az[ah]=0}var L=s?(ao-E)+(t*Q[0]):H+(t*Q[0]),K=p?(ax-D)+(t*Q[1]):G+(t*Q[1]),av=s?H+(t*az[0]):(ao-E)+(t*az[0]),au=p?G+(t*az[1]):(ax-D)+(t*az[1]),ac=L+(Q[0]*i),ab=K+(Q[1]*i),O=av+(az[0]*o),M=au+(az[1]*o),Y=Math.abs(L-av)>(i+o),aa=Math.abs(K-au)>(i+o),ak=ac+((O-ac)/2),ai=ab+((M-ab)/2),R=((Q[0]*az[0])+(Q[1]*az[1])),ae=R==-1,ag=R==0,F=R==1;am-=H;al-=G;v=[am,al,ao,ax,L,K,av,au];var ar=[];var V=Q[0]==0?"y":"x",P=ae?"opposite":F?"orthogonal":"perpendicular",I=jsPlumbUtil.segment([L,K],[av,au]),aj=Q[V=="x"?0:1]==-1,U={x:[null,4,3,2,1],y:[null,2,1,4,3]};if(aj){I=U[V][I]}k(ac,ab,L,K,av,au);var W=function(aD,aC,aA,aB){return aD+(aC*((1-aA)*aB)+Math.max(i,o))},J={oppositex:function(){if(C.elementId==T.elementId){var aA=ab+((1-ay.y)*at.height)+Math.max(i,o);return[[ac,aA],[O,aA]]}else{if(Y&&(I==1||I==2)){return[[ak,K],[ak,au]]}else{return[[ac,ai],[O,ai]]}}},orthogonalx:function(){if(I==1||I==2){return[[O,ab]]}else{return[[ac,M]]}},perpendicularx:function(){var aA=(au+K)/2;if((I==1&&az[1]==1)||(I==2&&az[1]==-1)){if(Math.abs(av-L)>Math.max(i,o)){return[[O,ab]]}else{return[[ac,ab],[ac,aA],[O,aA]]}}else{if((I==3&&az[1]==-1)||(I==4&&az[1]==1)){return[[ac,aA],[O,aA]]}else{if((I==3&&az[1]==1)||(I==4&&az[1]==-1)){return[[ac,M]]}else{if((I==1&&az[1]==-1)||(I==2&&az[1]==1)){if(Math.abs(av-L)>Math.max(i,o)){return[[ak,ab],[ak,M]]}else{return[[ac,M]]}}}}}},oppositey:function(){if(C.elementId==T.elementId){var aA=ac+((1-ay.x)*at.width)+Math.max(i,o);return[[aA,ab],[aA,M]]}else{if(aa&&(I==2||I==3)){return[[L,ai],[av,ai]]}else{return[[ak,ab],[ak,M]]}}},orthogonaly:function(){if(I==2||I==3){return[[ac,M]]}else{return[[O,ab]]}},perpendiculary:function(){var aA=(av+L)/2;if((I==2&&az[0]==-1)||(I==3&&az[0]==1)){if(Math.abs(av-L)>Math.max(i,o)){return[[ac,M]]}else{return[[ac,ai],[O,ai]]}}else{if((I==1&&az[0]==-1)||(I==4&&az[0]==1)){var aA=(av+L)/2;return[[aA,ab],[aA,M]]}else{if((I==1&&az[0]==1)||(I==4&&az[0]==-1)){return[[O,ab]]}else{if((I==2&&az[0]==1)||(I==3&&az[0]==-1)){if(Math.abs(au-K)>Math.max(i,o)){return[[ac,ai],[O,ai]]}else{return[[O,ab]]}}}}}}};var aq=J[P+V]();if(aq){for(var aw=0;aw<aq.length;aw++){k(aq[aw][0],aq[aw][1],L,K,av,au)}}k(O,M,L,K,av,au);k(av,au,L,K,av,au);l();B(L,K,av,au);if(w>v[3]){v[3]=w+(X*2)}if(y>v[2]){v[2]=y+(X*2)}return v};this.pointOnPath=function(C,D){return r.pointAlongPathFrom(C,0,D)};this.gradientAtPoint=function(C,D){return u[h(C,D)["index"]][4]};this.pointAlongPathFrom=function(J,C,I){var K=h(J,I),G=K.segment,D=K.proportion,F=u[K.index][5],E=u[K.index][4];var H={x:E==Infinity?G[2]:G[2]>G[0]?G[0]+((1-D)*F)-C:G[2]+(D*F)+C,y:E==0?G[3]:G[3]>G[1]?G[1]+((1-D)*F)-C:G[3]+(D*F)+C,segmentInfo:K};return H}};jsPlumb.Endpoints.Dot=function(e){this.type="Dot";var d=this;e=e||{};this.radius=e.radius||10;this.defaultOffset=0.5*this.radius;this.defaultInnerRadius=this.radius/3;this.compute=function(k,g,m,i){var h=m.radius||d.radius,f=k[0]-h,l=k[1]-h;return[f,l,h*2,h*2,h]}};jsPlumb.Endpoints.Rectangle=function(e){this.type="Rectangle";var d=this;e=e||{};this.width=e.width||20;this.height=e.height||20;this.compute=function(l,h,n,k){var i=n.width||d.width,g=n.height||d.height,f=l[0]-(i/2),m=l[1]-(g/2);return[f,m,i,g]}};var b=function(f){jsPlumb.DOMElementComponent.apply(this,arguments);var d=this;var e=[];this.getDisplayElements=function(){return e};this.appendDisplayElement=function(g){e.push(g)}};jsPlumb.Endpoints.Image=function(i){this.type="Image";b.apply(this,arguments);var n=this,h=false,g=false,f=i.width,e=i.height,l=null,d=i.endpoint;this.img=new Image();n.ready=false;this.img.onload=function(){n.ready=true;f=f||n.img.width;e=e||n.img.height;if(l){l(n)}};d.setImage=function(o,q){var p=o.constructor==String?o:o.src;l=q;n.img.src=o;if(n.canvas!=null){n.canvas.setAttribute("src",o)}};d.setImage(i.src||i.url,i.onload);this.compute=function(q,o,r,p){n.anchorPoint=q;if(n.ready){return[q[0]-f/2,q[1]-e/2,f,e]}else{return[0,0,0,0]}};n.canvas=document.createElement("img"),h=false;n.canvas.style.margin=0;n.canvas.style.padding=0;n.canvas.style.outline=0;n.canvas.style.position="absolute";var k=i.cssClass?" "+i.cssClass:"";n.canvas.className=jsPlumb.endpointClass+k;if(f){n.canvas.setAttribute("width",f)}if(e){n.canvas.setAttribute("height",e)}jsPlumb.appendElement(n.canvas,i.parent);n.attachListeners(n.canvas,n);n.cleanup=function(){g=true};var m=function(r,q,p){if(!g){if(!h){n.canvas.setAttribute("src",n.img.src);n.appendDisplayElement(n.canvas);h=true}var o=n.anchorPoint[0]-(f/2),s=n.anchorPoint[1]-(e/2);jsPlumb.sizeCanvas(n.canvas,o,s,f,e)}};this.paint=function(q,p,o){if(n.ready){m(q,p,o)}else{window.setTimeout(function(){n.paint(q,p,o)},200)}}};jsPlumb.Endpoints.Blank=function(e){var d=this;this.type="Blank";b.apply(this,arguments);this.compute=function(h,f,i,g){return[h[0],h[1],10,0]};d.canvas=document.createElement("div");d.canvas.style.display="block";d.canvas.style.width="1px";d.canvas.style.height="1px";d.canvas.style.background="transparent";d.canvas.style.position="absolute";d.canvas.className=d._jsPlumb.endpointClass;jsPlumb.appendElement(d.canvas,e.parent);this.paint=function(h,g,f){jsPlumb.sizeCanvas(d.canvas,h[0],h[1],h[2],h[3])}};jsPlumb.Endpoints.Triangle=function(d){this.type="Triangle";d=d||{};d.width=d.width||55;d.height=d.height||55;this.width=d.width;this.height=d.height;this.compute=function(k,g,m,i){var h=m.width||self.width,f=m.height||self.height,e=k[0]-(h/2),l=k[1]-(f/2);return[e,l,h,f]}};var c=function(f){var e=true,d=this;this.isAppendedAtTopLevel=true;this.component=f.component;this.loc=f.location==null?0.5:f.location;this.endpointLoc=f.endpointLocation==null?[0.5,0.5]:f.endpointLocation;this.setVisible=function(g){e=g;d.component.repaint()};this.isVisible=function(){return e};this.hide=function(){d.setVisible(false)};this.show=function(){d.setVisible(true)};this.incrementLocation=function(g){d.loc+=g;d.component.repaint()};this.setLocation=function(g){d.loc=g;d.component.repaint()};this.getLocation=function(){return d.loc}};jsPlumb.Overlays.Arrow=function(h){this.type="Arrow";c.apply(this,arguments);this.isAppendedAtTopLevel=false;h=h||{};var e=this;this.length=h.length||20;this.width=h.width||20;this.id=h.id;var g=(h.direction||1)<0?-1:1,f=h.paintStyle||{lineWidth:1},d=h.foldback||0.623;this.computeMaxSize=function(){return e.width*1.5};this.cleanup=function(){};this.draw=function(m,A,v){var p,w,i,q,o;if(m.pointAlongPathFrom){if(jsPlumbUtil.isString(e.loc)||e.loc>1||e.loc<0){var k=parseInt(e.loc);p=m.pointAlongPathFrom(k,g*e.length/2,true),w=m.pointOnPath(k,true),i=jsPlumbUtil.pointOnLine(p,w,e.length)}else{if(e.loc==1){p=m.pointOnPath(e.loc);w=m.pointAlongPathFrom(e.loc,-1);i=jsPlumbUtil.pointOnLine(p,w,e.length)}else{if(e.loc==0){i=m.pointOnPath(e.loc);w=m.pointAlongPathFrom(e.loc,1);p=jsPlumbUtil.pointOnLine(i,w,e.length)}else{p=m.pointAlongPathFrom(e.loc,g*e.length/2),w=m.pointOnPath(e.loc),i=jsPlumbUtil.pointOnLine(p,w,e.length)}}}q=jsPlumbUtil.perpendicularLineTo(p,i,e.width);o=jsPlumbUtil.pointOnLine(p,i,d*e.length);var z=Math.min(p.x,q[0].x,q[1].x),t=Math.max(p.x,q[0].x,q[1].x),y=Math.min(p.y,q[0].y,q[1].y),s=Math.max(p.y,q[0].y,q[1].y);var r={hxy:p,tail:q,cxy:o},u=f.strokeStyle||A.strokeStyle,x=f.fillStyle||A.strokeStyle,n=f.lineWidth||A.lineWidth;e.paint(m,r,n,u,x,v);return[z,t,y,s]}else{return[0,0,0,0]}}};jsPlumb.Overlays.PlainArrow=function(e){e=e||{};var d=jsPlumb.extend(e,{foldback:1});jsPlumb.Overlays.Arrow.call(this,d);this.type="PlainArrow"};jsPlumb.Overlays.Diamond=function(f){f=f||{};var d=f.length||40,e=jsPlumb.extend(f,{length:d/2,foldback:2});jsPlumb.Overlays.Arrow.call(this,e);this.type="Diamond"};var a=function(i){jsPlumb.DOMElementComponent.apply(this,arguments);c.apply(this,arguments);var d=this,e=false;i=i||{};this.id=i.id;var l;var h=function(){l=i.create(i.component);l=jsPlumb.CurrentLibrary.getDOMElement(l);l.style.position="absolute";var m=i._jsPlumb.overlayClass+" "+(d.cssClass?d.cssClass:i.cssClass?i.cssClass:"");l.className=m;jsPlumb.appendElement(l,i.component.parent);i._jsPlumb.getId(l);d.attachListeners(l,d);d.canvas=l};this.getElement=function(){if(l==null){h()}return l};this.getDimensions=function(){return jsPlumb.CurrentLibrary.getSize(jsPlumb.CurrentLibrary.getElementObject(d.getElement()))};var f=null,k=function(m){if(f==null){f=d.getDimensions()}return f};this.clearCachedDimensions=function(){f=null};this.computeMaxSize=function(){var m=k();return Math.max(m[0],m[1])};var g=d.setVisible;d.setVisible=function(m){g(m);l.style.display=m?"block":"none"};this.cleanup=function(){if(l!=null){jsPlumb.CurrentLibrary.removeElement(l)}};this.paint=function(m,o,n){if(!e){d.getElement();m.appendDisplayElement(l);d.attachListeners(l,m);e=true}l.style.left=(n[0]+o.minx)+"px";l.style.top=(n[1]+o.miny)+"px"};this.draw=function(n,o,p){var t=k();if(t!=null&&t.length==2){var q={x:0,y:0};if(n.pointOnPath){var r=d.loc,s=false;if(jsPlumbUtil.isString(d.loc)||d.loc<0||d.loc>1){r=parseInt(d.loc);s=true}q=n.pointOnPath(r,s)}else{var m=d.loc.constructor==Array?d.loc:d.endpointLoc;q={x:m[0]*p[2],y:m[1]*p[3]}}minx=q.x-(t[0]/2),miny=q.y-(t[1]/2);d.paint(n,{minx:minx,miny:miny,td:t,cxy:q},p);return[minx,minx+t[0],miny,miny+t[1]]}else{return[0,0,0,0]}};this.reattachListeners=function(m){if(l){d.reattachListenersForElement(l,d,m)}}};jsPlumb.Overlays.Custom=function(d){this.type="Custom";a.apply(this,arguments)};jsPlumb.Overlays.Label=function(h){var d=this;this.labelStyle=h.labelStyle||jsPlumb.Defaults.LabelStyle;this.cssClass=this.labelStyle!=null?this.labelStyle.cssClass:null;h.create=function(){return document.createElement("div")};jsPlumb.Overlays.Custom.apply(this,arguments);this.type="Label";var f=h.label||"",d=this,g=null;this.setLabel=function(k){f=k;g=null;cachedDimensions=null;e();d.component.repaint()};var e=function(){if(typeof f=="function"){var k=f(d);d.getElement().innerHTML=k.replace(/\r\n/g,"<br/>")}else{if(g==null){g=f;d.getElement().innerHTML=g.replace(/\r\n/g,"<br/>")}}};this.getLabel=function(){return f};var i=this.getDimensions;this.getDimensions=function(){e();return i()}};jsPlumb.Overlays.GuideLines=function(){var d=this;d.length=50;d.lineWidth=5;this.type="GuideLines";c.apply(this,arguments);jsPlumb.jsPlumbUIComponent.apply(this,arguments);this.draw=function(f,m,l){var k=f.pointAlongPathFrom(d.loc,d.length/2),i=f.pointOnPath(d.loc),h=jsPlumbUtil.pointOnLine(k,i,d.length),g=jsPlumbUtil.perpendicularLineTo(k,h,40),e=jsPlumbUtil.perpendicularLineTo(h,k,20);d.paint(f,[k,h,g,e],d.lineWidth,"red",null,l);return[Math.min(k.x,h.x),Math.min(k.y,h.y),Math.max(k.x,h.x),Math.max(k.y,h.y)]};this.computeMaxSize=function(){return 50};this.cleanup=function(){}}})();(function(){var c=function(e,g,d,f){this.m=(f-g)/(d-e);this.b=-1*((this.m*e)-g);this.rectIntersect=function(q,p,s,o){var n=[];var k=(p-this.b)/this.m;if(k>=q&&k<=(q+s)){n.push([k,(this.m*k)+this.b])}var t=(this.m*(q+s))+this.b;if(t>=p&&t<=(p+o)){n.push([(t-this.b)/this.m,t])}var k=((p+o)-this.b)/this.m;if(k>=q&&k<=(q+s)){n.push([k,(this.m*k)+this.b])}var t=(this.m*q)+this.b;if(t>=p&&t<=(p+o)){n.push([(t-this.b)/this.m,t])}if(n.length==2){var m=(n[0][0]+n[1][0])/2,l=(n[0][1]+n[1][1])/2;n.push([m,l]);var i=m<=q+(s/2)?-1:1,r=l<=p+(o/2)?-1:1;n.push([i,r]);return n}return null}},a=function(e,g,d,f){if(e<=d&&f<=g){return 1}else{if(e<=d&&g<=f){return 2}else{if(d<=e&&f>=g){return 3}}}return 4},b=function(g,f,i,e,h,m,l,d,k){if(d<=k){return[g,f]}if(i==1){if(e[3]<=0&&h[3]>=1){return[g+(e[2]<0.5?-1*m:m),f]}else{if(e[2]>=1&&h[2]<=0){return[g,f+(e[3]<0.5?-1*l:l)]}else{return[g+(-1*m),f+(-1*l)]}}}else{if(i==2){if(e[3]>=1&&h[3]<=0){return[g+(e[2]<0.5?-1*m:m),f]}else{if(e[2]>=1&&h[2]<=0){return[g,f+(e[3]<0.5?-1*l:l)]}else{return[g+(1*m),f+(-1*l)]}}}else{if(i==3){if(e[3]>=1&&h[3]<=0){return[g+(e[2]<0.5?-1*m:m),f]}else{if(e[2]<=0&&h[2]>=1){return[g,f+(e[3]<0.5?-1*l:l)]}else{return[g+(-1*m),f+(-1*l)]}}}else{if(i==4){if(e[3]<=0&&h[3]>=1){return[g+(e[2]<0.5?-1*m:m),f]}else{if(e[2]<=0&&h[2]>=1){return[g,f+(e[3]<0.5?-1*l:l)]}else{return[g+(1*m),f+(-1*l)]}}}}}}};jsPlumb.Connectors.StateMachine=function(l){var u=this,n=null,o,m,g,e,p=[],d=l.curviness||10,k=l.margin||5,q=l.proximityLimit||80,f=l.orientation&&l.orientation=="clockwise",i=l.loopbackRadius||25,h=false,t=l.showLoopback!==false;this.type="StateMachine";l=l||{};this.compute=function(ad,H,W,I,ac,z,v,U){var Q=Math.abs(ad[0]-H[0]),Y=Math.abs(ad[1]-H[1]),S=0.45*Q,ab=0.45*Y;Q*=1.9;Y*=1.9;v=v||1;var O=Math.min(ad[0],H[0])-S,M=Math.min(ad[1],H[1])-ab;if(!t||(W.elementId!=I.elementId)){h=false;o=ad[0]<H[0]?S:Q-S;m=ad[1]<H[1]?ab:Y-ab;g=ad[0]<H[0]?Q-S:S;e=ad[1]<H[1]?Y-ab:ab;if(ad[2]==0){o-=k}if(ad[2]==1){o+=k}if(ad[3]==0){m-=k}if(ad[3]==1){m+=k}if(H[2]==0){g-=k}if(H[2]==1){g+=k}if(H[3]==0){e-=k}if(H[3]==1){e+=k}var N=(o+g)/2,L=(m+e)/2,A=(-1*N)/L,V=Math.atan(A),P=(A==Infinity||A==-Infinity)?0:Math.abs(d/2*Math.sin(V)),R=(A==Infinity||A==-Infinity)?0:Math.abs(d/2*Math.cos(V)),B=a(o,m,g,e),J=Math.sqrt(Math.pow(g-o,2)+Math.pow(e-m,2));p=b(N,L,B,ad,H,d,d,J,q);var G=Math.max(Math.abs(p[0]-o)*3,Math.abs(p[0]-g)*3,Math.abs(g-o),2*v,U),K=Math.max(Math.abs(p[1]-m)*3,Math.abs(p[1]-e)*3,Math.abs(e-m),2*v,U);if(Q<G){var T=G-Q;O-=(T/2);o+=(T/2);g+=(T/2);Q=G;p[0]+=(T/2)}if(Y<K){var aa=K-Y;M-=(aa/2);m+=(aa/2);e+=(aa/2);Y=K;p[1]+=(aa/2)}n=[O,M,Q,Y,o,m,g,e,p[0],p[1]]}else{h=true;var Z=ad[0],X=ad[0],F=ad[1]-k,D=ad[1]-k,E=Z,C=F-i;Q=((2*v)+(4*i)),Y=((2*v)+(4*i));O=E-i-v-i,M=C-i-v-i;n=[O,M,Q,Y,E-O,C-M,i,f,Z-O,F-M,X-O,D-M]}return n};var r=function(){return[{x:g,y:e},{x:p[0],y:p[1]},{x:p[0]+1,y:p[1]+1},{x:o,y:m}]};var s=function(w,v,x){if(x){v=jsBezier.locationAlongCurveFrom(w,v>0?0:1,v)}return v};this.pointOnPath=function(x,B){if(h){if(B){var y=Math.PI*2*i;x=x/y}if(x>0&&x<1){x=1-x}var z=(x*2*Math.PI)+(Math.PI/2),w=n[4]+(n[6]*Math.cos(z)),v=n[5]+(n[6]*Math.sin(z));return{x:w,y:v}}else{var A=r();x=s(A,x,B);return jsBezier.pointOnCurve(A,x)}};this.gradientAtPoint=function(v,y){if(h){if(y){var w=Math.PI*2*i;v=v/w}return Math.atan(v*2*Math.PI)}else{var x=r();v=s(x,v,y);return jsBezier.gradientAtPoint(x,v)}};this.pointAlongPathFrom=function(D,v,C){if(h){if(C){var B=Math.PI*2*i;D=D/B}if(D>0&&D<1){D=1-D}var B=2*Math.PI*n[6],w=v/B*2*Math.PI,z=(D*2*Math.PI)-w+(Math.PI/2),y=n[4]+(n[6]*Math.cos(z)),x=n[5]+(n[6]*Math.sin(z));return{x:y,y:x}}else{var A=r();D=s(A,D,C);return jsBezier.pointAlongCurveFrom(A,D,v)}}};jsPlumb.Connectors.canvas.StateMachine=function(f){f=f||{};var d=this,g=f.drawGuideline||true,e=f.avoidSelector;jsPlumb.Connectors.StateMachine.apply(this,arguments);jsPlumb.CanvasConnector.apply(this,arguments);this._paint=function(l){if(l.length==10){d.ctx.beginPath();d.ctx.moveTo(l[4],l[5]);d.ctx.bezierCurveTo(l[8],l[9],l[8],l[9],l[6],l[7]);d.ctx.stroke()}else{d.ctx.save();d.ctx.beginPath();var k=0,i=2*Math.PI,h=l[7];d.ctx.arc(l[4],l[5],l[6],0,i,h);d.ctx.stroke();d.ctx.closePath();d.ctx.restore()}};this.createGradient=function(i,h){return h.createLinearGradient(i[4],i[5],i[6],i[7])}};jsPlumb.Connectors.svg.StateMachine=function(){var d=this;jsPlumb.Connectors.StateMachine.apply(this,arguments);jsPlumb.SvgConnector.apply(this,arguments);this.getPath=function(e){if(e.length==10){return"M "+e[4]+" "+e[5]+" C "+e[8]+" "+e[9]+" "+e[8]+" "+e[9]+" "+e[6]+" "+e[7]}else{return"M"+(e[8]+4)+" "+e[9]+" A "+e[6]+" "+e[6]+" 0 1,0 "+(e[8]-4)+" "+e[9]}}};jsPlumb.Connectors.vml.StateMachine=function(){jsPlumb.Connectors.StateMachine.apply(this,arguments);jsPlumb.VmlConnector.apply(this,arguments);var d=jsPlumb.vml.convertValue;this.getPath=function(k){if(k.length==10){return"m"+d(k[4])+","+d(k[5])+" c"+d(k[8])+","+d(k[9])+","+d(k[8])+","+d(k[9])+","+d(k[6])+","+d(k[7])+" e"}else{var h=d(k[8]-k[6]),g=d(k[9]-(2*k[6])),f=h+d(2*k[6]),e=g+d(2*k[6]),l=h+","+g+","+f+","+e;var i="ar "+l+","+d(k[8])+","+d(k[9])+","+d(k[8])+","+d(k[9])+" e";return i}}}})();(function(){var h={"stroke-linejoin":"joinstyle",joinstyle:"joinstyle",endcap:"endcap",miterlimit:"miterlimit"},c=null;if(document.createStyleSheet&&document.namespaces){var m=[".jsplumb_vml","jsplumb\\:textbox","jsplumb\\:oval","jsplumb\\:rect","jsplumb\\:stroke","jsplumb\\:shape","jsplumb\\:group"],g="behavior:url(#default#VML);position:absolute;";c=document.createStyleSheet();for(var r=0;r<m.length;r++){c.addRule(m[r],g)}document.namespaces.add("jsplumb","urn:schemas-microsoft-com:vml")}jsPlumb.vml={};var t=1000,s={},a=function(u,i){var w=jsPlumb.getId(u),v=s[w];if(!v){v=f("group",[0,0,t,t],{"class":i});v.style.backgroundColor="red";s[w]=v;jsPlumb.appendElement(v,u)}return v},e=function(v,w){for(var u in w){v[u]=w[u]}},f=function(u,y,z,w,i,v){z=z||{};var x=document.createElement("jsplumb:"+u);if(v){i.appendElement(x,w)}else{jsPlumb.CurrentLibrary.appendElement(x,w)}x.className=(z["class"]?z["class"]+" ":"")+"jsplumb_vml";k(x,y);e(x,z);return x},k=function(u,i,v){u.style.left=i[0]+"px";u.style.top=i[1]+"px";u.style.width=i[2]+"px";u.style.height=i[3]+"px";u.style.position="absolute";if(v){u.style.zIndex=v}},p=jsPlumb.vml.convertValue=function(i){return Math.floor(i*t)},b=function(w,u,v,i){if("transparent"===u){i.setOpacity(v,"0.0")}else{i.setOpacity(v,"1.0")}},q=function(y,u,B,C){var x={};if(u.strokeStyle){x.stroked="true";var D=jsPlumbUtil.convertStyle(u.strokeStyle,true);x.strokecolor=D;b(x,D,"stroke",B);x.strokeweight=u.lineWidth+"px"}else{x.stroked="false"}if(u.fillStyle){x.filled="true";var v=jsPlumbUtil.convertStyle(u.fillStyle,true);x.fillcolor=v;b(x,v,"fill",B)}else{x.filled="false"}if(u.dashstyle){if(B.strokeNode==null){B.strokeNode=f("stroke",[0,0,0,0],{dashstyle:u.dashstyle},y,C)}else{B.strokeNode.dashstyle=u.dashstyle}}else{if(u["stroke-dasharray"]&&u.lineWidth){var E=u["stroke-dasharray"].indexOf(",")==-1?" ":",",z=u["stroke-dasharray"].split(E),w="";for(var A=0;A<z.length;A++){w+=(Math.floor(z[A]/u.lineWidth)+E)}if(B.strokeNode==null){B.strokeNode=f("stroke",[0,0,0,0],{dashstyle:w},y,C)}else{B.strokeNode.dashstyle=w}}}e(y,x)},n=function(){var i=this;jsPlumb.jsPlumbUIComponent.apply(this,arguments);this.opacityNodes={stroke:null,fill:null};this.initOpacityNodes=function(v){i.opacityNodes.stroke=f("stroke",[0,0,1,1],{opacity:"0.0"},v,i._jsPlumb);i.opacityNodes.fill=f("fill",[0,0,1,1],{opacity:"0.0"},v,i._jsPlumb)};this.setOpacity=function(v,x){var w=i.opacityNodes[v];if(w){w.opacity=""+x}};var u=[];this.getDisplayElements=function(){return u};this.appendDisplayElement=function(w,v){if(!v){i.canvas.parentNode.appendChild(w)}u.push(w)}},d=jsPlumb.VmlConnector=function(v){var i=this;i.strokeNode=null;i.canvas=null;n.apply(this,arguments);var u=i._jsPlumb.connectorClass+(v.cssClass?(" "+v.cssClass):"");this.paint=function(A,x,z){if(x!=null){var E=i.getPath(A),y={path:E};if(x.outlineColor){var C=x.outlineWidth||1,D=x.lineWidth+(2*C),B={strokeStyle:jsPlumbUtil.convertStyle(x.outlineColor),lineWidth:D};for(var w in h){B[w]=x[w]}if(i.bgCanvas==null){y["class"]=u;y.coordsize=(A[2]*t)+","+(A[3]*t);i.bgCanvas=f("shape",A,y,v.parent,i._jsPlumb,true);k(i.bgCanvas,A,i.getZIndex());i.appendDisplayElement(i.bgCanvas,true);i.attachListeners(i.bgCanvas,i);i.initOpacityNodes(i.bgCanvas,["stroke"])}else{y.coordsize=(A[2]*t)+","+(A[3]*t);k(i.bgCanvas,A,i.getZIndex());e(i.bgCanvas,y)}q(i.bgCanvas,B,i)}if(i.canvas==null){y["class"]=u;y.coordsize=(A[2]*t)+","+(A[3]*t);if(i.tooltip){y.label=i.tooltip}i.canvas=f("shape",A,y,v.parent,i._jsPlumb,true);i.appendDisplayElement(i.canvas,true);i.attachListeners(i.canvas,i);i.initOpacityNodes(i.canvas,["stroke"])}else{y.coordsize=(A[2]*t)+","+(A[3]*t);k(i.canvas,A,i.getZIndex());e(i.canvas,y)}q(i.canvas,x,i,i._jsPlumb)}};this.reattachListeners=function(){if(i.canvas){i.reattachListenersForElement(i.canvas,i)}}},l=window.VmlEndpoint=function(y){n.apply(this,arguments);var i=null,v=this,u=null,x=null;v.canvas=document.createElement("div");v.canvas.style.position="absolute";var w=v._jsPlumb.endpointClass+(y.cssClass?(" "+y.cssClass):"");y._jsPlumb.appendElement(v.canvas,y.parent);if(v.tooltip){v.canvas.setAttribute("label",v.tooltip)}this.paint=function(C,A,z){var B={};jsPlumb.sizeCanvas(v.canvas,C[0],C[1],C[2],C[3]);if(i==null){B["class"]=w;i=v.getVml([0,0,C[2],C[3]],B,z,v.canvas,v._jsPlumb);v.attachListeners(i,v);v.appendDisplayElement(i,true);v.appendDisplayElement(v.canvas,true);v.initOpacityNodes(i,["fill"])}else{k(i,[0,0,C[2],C[3]]);e(i,B)}q(i,A,v)};this.reattachListeners=function(){if(i){v.reattachListenersForElement(i,v)}}};jsPlumb.Connectors.vml.Bezier=function(){jsPlumb.Connectors.Bezier.apply(this,arguments);d.apply(this,arguments);this.getPath=function(i){return"m"+p(i[4])+","+p(i[5])+" c"+p(i[8])+","+p(i[9])+","+p(i[10])+","+p(i[11])+","+p(i[6])+","+p(i[7])+" e"}};jsPlumb.Connectors.vml.Straight=function(){jsPlumb.Connectors.Straight.apply(this,arguments);d.apply(this,arguments);this.getPath=function(i){return"m"+p(i[4])+","+p(i[5])+" l"+p(i[6])+","+p(i[7])+" e"}};jsPlumb.Connectors.vml.Flowchart=function(){jsPlumb.Connectors.Flowchart.apply(this,arguments);d.apply(this,arguments);this.getPath=function(v){var w="m "+p(v[4])+","+p(v[5])+" l";for(var u=0;u<v[8];u++){w=w+" "+p(v[9+(u*2)])+","+p(v[10+(u*2)])}w=w+" "+p(v[6])+","+p(v[7])+" e";return w}};jsPlumb.Endpoints.vml.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments);l.apply(this,arguments);this.getVml=function(w,x,u,v,i){return f("oval",w,x,v,i)}};jsPlumb.Endpoints.vml.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments);l.apply(this,arguments);this.getVml=function(w,x,u,v,i){return f("rect",w,x,v,i)}};jsPlumb.Endpoints.vml.Image=jsPlumb.Endpoints.Image;jsPlumb.Endpoints.vml.Blank=jsPlumb.Endpoints.Blank;jsPlumb.Overlays.vml.Label=jsPlumb.Overlays.Label;jsPlumb.Overlays.vml.Custom=jsPlumb.Overlays.Custom;var o=function(x,v){x.apply(this,v);n.apply(this,v);var u=this,w=null;u.canvas=null;u.isAppendedAtTopLevel=true;var i=function(z,y){return"m "+p(z.hxy.x)+","+p(z.hxy.y)+" l "+p(z.tail[0].x)+","+p(z.tail[0].y)+" "+p(z.cxy.x)+","+p(z.cxy.y)+" "+p(z.tail[1].x)+","+p(z.tail[1].y)+" x e"};this.paint=function(B,G,F,H,L,K){var z={};if(H){z.stroked="true";z.strokecolor=jsPlumbUtil.convertStyle(H,true)}if(F){z.strokeweight=F+"px"}if(L){z.filled="true";z.fillcolor=L}var y=Math.min(G.hxy.x,G.tail[0].x,G.tail[1].x,G.cxy.x),J=Math.min(G.hxy.y,G.tail[0].y,G.tail[1].y,G.cxy.y),C=Math.max(G.hxy.x,G.tail[0].x,G.tail[1].x,G.cxy.x),A=Math.max(G.hxy.y,G.tail[0].y,G.tail[1].y,G.cxy.y),I=Math.abs(C-y),E=Math.abs(A-J),D=[y,J,I,E];z.path=i(G,K);z.coordsize=(K[2]*t)+","+(K[3]*t);D[0]=K[0];D[1]=K[1];D[2]=K[2];D[3]=K[3];if(u.canvas==null){u.canvas=f("shape",D,z,B.canvas.parentNode,B._jsPlumb,true);B.appendDisplayElement(u.canvas,true);u.attachListeners(u.canvas,B);u.attachListeners(u.canvas,u)}else{k(u.canvas,D);e(u.canvas,z)}};this.reattachListeners=function(){if(u.canvas){u.reattachListenersForElement(u.canvas,u)}};this.cleanup=function(){if(u.canvas!=null){jsPlumb.CurrentLibrary.removeElement(u.canvas)}}};jsPlumb.Overlays.vml.Arrow=function(){o.apply(this,[jsPlumb.Overlays.Arrow,arguments])};jsPlumb.Overlays.vml.PlainArrow=function(){o.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])};jsPlumb.Overlays.vml.Diamond=function(){o.apply(this,[jsPlumb.Overlays.Diamond,arguments])}})();(function(){var l={joinstyle:"stroke-linejoin","stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},w="stroke-dasharray",A="dashstyle",e="linearGradient",b="radialGradient",c="fill",a="stop",z="stroke",q="stroke-width",h="style",m="none",t="jsplumb_gradient_",o="lineWidth",C={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml"},g=function(F,D){for(var E in D){F.setAttribute(E,""+D[E])}},f=function(E,D){var F=document.createElementNS(C.svg,E);D=D||{};D.version="1.1";D.xmlns=C.xhtml;g(F,D);return F},n=function(D){return"position:absolute;left:"+D[0]+"px;top:"+D[1]+"px"},i=function(E){for(var D=0;D<E.childNodes.length;D++){if(E.childNodes[D].tagName==e||E.childNodes[D].tagName==b){E.removeChild(E.childNodes[D])}}},v=function(N,I,F,D,J){var G=t+J._jsPlumb.idstamp();i(N);if(!F.gradient.offset){var L=f(e,{id:G,gradientUnits:"userSpaceOnUse"});N.appendChild(L)}else{var L=f(b,{id:G});N.appendChild(L)}for(var K=0;K<F.gradient.stops.length;K++){var H=K;if(D.length==8){H=D[4]<D[6]?K:F.gradient.stops.length-1-K}else{H=D[4]<D[6]?F.gradient.stops.length-1-K:K}var M=jsPlumbUtil.convertStyle(F.gradient.stops[H][1],true);var O=f(a,{offset:Math.floor(F.gradient.stops[K][0]*100)+"%","stop-color":M});L.appendChild(O)}var E=F.strokeStyle?z:c;I.setAttribute(h,E+":url(#"+G+")")},x=function(K,G,E,D,H){if(E.gradient){v(K,G,E,D,H)}else{i(K);G.setAttribute(h,"")}G.setAttribute(c,E.fillStyle?jsPlumbUtil.convertStyle(E.fillStyle,true):m);G.setAttribute(z,E.strokeStyle?jsPlumbUtil.convertStyle(E.strokeStyle,true):m);if(E.lineWidth){G.setAttribute(q,E.lineWidth)}if(E[A]&&E[o]&&!E[w]){var L=E[A].indexOf(",")==-1?" ":",",I=E[A].split(L),F="";I.forEach(function(M){F+=(Math.floor(M*E.lineWidth)+L)});G.setAttribute(w,F)}else{if(E[w]){G.setAttribute(w,E[w])}}for(var J in l){if(E[J]){G.setAttribute(l[J],E[J])}}},B=function(F){var D=/([0-9].)(p[xt])\s(.*)/;var E=F.match(D);return{size:E[1]+E[2],font:E[3]}},r=function(I,J,E){var K=E.split(" "),H=I.className,G=H.baseVal.split(" ");for(var F=0;F<K.length;F++){if(J){if(G.indexOf(K[F])==-1){G.push(K[F])}}else{var D=G.indexOf(K[F]);if(D!=-1){G.splice(D,1)}}}I.className.baseVal=G.join(" ")},u=function(E,D){r(E,true,D)},k=function(E,D){r(E,false,D)};jsPlumbUtil.svg={addClass:u,removeClass:k,node:f,attr:g,pos:n};var s=function(H){var D=this,G=H.pointerEventsSpec||"all";jsPlumb.jsPlumbUIComponent.apply(this,H.originalArgs);D.canvas=null,D.path=null,D.svg=null;var F=H.cssClass+" "+(H.originalArgs[0].cssClass||""),I={style:"",width:0,height:0,"pointer-events":G,position:"absolute"};if(D.tooltip){I.title=D.tooltip}D.svg=f("svg",I);if(H.useDivWrapper){D.canvas=document.createElement("div");D.canvas.style.position="absolute";jsPlumb.sizeCanvas(D.canvas,0,0,1,1);D.canvas.className=F;if(D.tooltip){D.canvas.setAttribute("title",D.tooltip)}}else{g(D.svg,{"class":F});D.canvas=D.svg}H._jsPlumb.appendElement(D.canvas,H.originalArgs[0]["parent"]);if(H.useDivWrapper){D.canvas.appendChild(D.svg)}var E=[D.canvas];this.getDisplayElements=function(){return E};this.appendDisplayElement=function(J){E.push(J)};this.paint=function(N,L,K){if(L!=null){var J=N[0],O=N[1];if(H.useDivWrapper){jsPlumb.sizeCanvas(D.canvas,N[0],N[1],N[2],N[3]);J=0,O=0}var M=n([J,O,N[2],N[3]]);if(D.getZIndex()){M+=";z-index:"+D.getZIndex()+";"}g(D.svg,{style:M,width:N[2],height:N[3]});D._paint.apply(this,arguments)}}};var d=jsPlumb.SvgConnector=function(E){var D=this;s.apply(this,[{cssClass:E._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",tooltip:E.tooltip,_jsPlumb:E._jsPlumb}]);this._paint=function(L,H){var K=D.getPath(L),F={d:K},J=null;F["pointer-events"]="all";if(H.outlineColor){var I=H.outlineWidth||1,G=H.lineWidth+(2*I),J=jsPlumb.CurrentLibrary.extend({},H);J.strokeStyle=jsPlumbUtil.convertStyle(H.outlineColor);J.lineWidth=G;if(D.bgPath==null){D.bgPath=f("path",F);D.svg.appendChild(D.bgPath);D.attachListeners(D.bgPath,D)}else{g(D.bgPath,F)}x(D.svg,D.bgPath,J,L,D)}if(D.path==null){D.path=f("path",F);D.svg.appendChild(D.path);D.attachListeners(D.path,D)}else{g(D.path,F)}x(D.svg,D.path,H,L,D)};this.reattachListeners=function(){if(D.bgPath){D.reattachListenersForElement(D.bgPath,D)}if(D.path){D.reattachListenersForElement(D.path,D)}}};jsPlumb.Connectors.svg.Bezier=function(D){jsPlumb.Connectors.Bezier.apply(this,arguments);d.apply(this,arguments);this.getPath=function(F){var E="M "+F[4]+" "+F[5];E+=(" C "+F[8]+" "+F[9]+" "+F[10]+" "+F[11]+" "+F[6]+" "+F[7]);return E}};jsPlumb.Connectors.svg.Straight=function(D){jsPlumb.Connectors.Straight.apply(this,arguments);d.apply(this,arguments);this.getPath=function(E){return"M "+E[4]+" "+E[5]+" L "+E[6]+" "+E[7]}};jsPlumb.Connectors.svg.Flowchart=function(){var D=this;jsPlumb.Connectors.Flowchart.apply(this,arguments);d.apply(this,arguments);this.getPath=function(F){var G="M "+F[4]+","+F[5];for(var E=0;E<F[8];E++){G=G+" L "+F[9+(E*2)]+" "+F[10+(E*2)]}G=G+" "+F[6]+","+F[7];return G}};var y=window.SvgEndpoint=function(E){var D=this;s.apply(this,[{cssClass:E._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:true,_jsPlumb:E._jsPlumb}]);this._paint=function(H,G){var F=jsPlumb.extend({},G);if(F.outlineColor){F.strokeWidth=F.outlineWidth;F.strokeStyle=jsPlumbUtil.convertStyle(F.outlineColor,true)}if(D.node==null){D.node=D.makeNode(H,F);D.svg.appendChild(D.node);D.attachListeners(D.node,D)}x(D.svg,D.node,F,H,D);n(D.node,H)};this.reattachListeners=function(){if(D.node){D.reattachListenersForElement(D.node,D)}}};jsPlumb.Endpoints.svg.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments);y.apply(this,arguments);this.makeNode=function(E,D){return f("circle",{cx:E[2]/2,cy:E[3]/2,r:E[2]/2})}};jsPlumb.Endpoints.svg.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments);y.apply(this,arguments);this.makeNode=function(E,D){return f("rect",{width:E[2],height:E[3]})}};jsPlumb.Endpoints.svg.Image=jsPlumb.Endpoints.Image;jsPlumb.Endpoints.svg.Blank=jsPlumb.Endpoints.Blank;jsPlumb.Overlays.svg.Label=jsPlumb.Overlays.Label;jsPlumb.Overlays.svg.Custom=jsPlumb.Overlays.Custom;var p=function(H,F){H.apply(this,F);jsPlumb.jsPlumbUIComponent.apply(this,F);this.isAppendedAtTopLevel=false;var D=this,G=null;this.paint=function(J,M,I,N,K){if(G==null){G=f("path",{"pointer-events":"all"});J.svg.appendChild(G);D.attachListeners(G,J);D.attachListeners(G,D)}var L=F&&(F.length==1)?(F[0].cssClass||""):"";g(G,{d:E(M),"class":L,stroke:N?N:null,fill:K?K:null})};var E=function(I){return"M"+I.hxy.x+","+I.hxy.y+" L"+I.tail[0].x+","+I.tail[0].y+" L"+I.cxy.x+","+I.cxy.y+" L"+I.tail[1].x+","+I.tail[1].y+" L"+I.hxy.x+","+I.hxy.y};this.reattachListeners=function(){if(G){D.reattachListenersForElement(G,D)}};this.cleanup=function(){if(G!=null){jsPlumb.CurrentLibrary.removeElement(G)}}};jsPlumb.Overlays.svg.Arrow=function(){p.apply(this,[jsPlumb.Overlays.Arrow,arguments])};jsPlumb.Overlays.svg.PlainArrow=function(){p.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])};jsPlumb.Overlays.svg.Diamond=function(){p.apply(this,[jsPlumb.Overlays.Diamond,arguments])};jsPlumb.Overlays.svg.GuideLines=function(){var I=null,D=this,H=null,G,F;jsPlumb.Overlays.GuideLines.apply(this,arguments);this.paint=function(K,M,J,N,L){if(I==null){I=f("path");K.svg.appendChild(I);D.attachListeners(I,K);D.attachListeners(I,D);G=f("path");K.svg.appendChild(G);D.attachListeners(G,K);D.attachListeners(G,D);F=f("path");K.svg.appendChild(F);D.attachListeners(F,K);D.attachListeners(F,D)}g(I,{d:E(M[0],M[1]),stroke:"red",fill:null});g(G,{d:E(M[2][0],M[2][1]),stroke:"blue",fill:null});g(F,{d:E(M[3][0],M[3][1]),stroke:"green",fill:null})};var E=function(K,J){return"M "+K.x+","+K.y+" L"+J.x+","+J.y}}})();(function(){var d=null,i=function(p,o){return jsPlumb.CurrentLibrary.hasClass(a(p),o)},a=function(o){return jsPlumb.CurrentLibrary.getElementObject(o)},m=function(o){return jsPlumb.CurrentLibrary.getOffset(a(o))},n=function(o){return jsPlumb.CurrentLibrary.getPageXY(o)},f=function(o){return jsPlumb.CurrentLibrary.getClientXY(o)};var k=function(){var q=this;q.overlayPlacements=[];jsPlumb.jsPlumbUIComponent.apply(this,arguments);jsPlumbUtil.EventGenerator.apply(this,arguments);this._over=function(z){var B=m(a(q.canvas)),D=n(z),u=D[0]-B.left,C=D[1]-B.top;if(u>0&&C>0&&u<q.canvas.width&&C<q.canvas.height){for(var v=0;v<q.overlayPlacements.length;v++){var w=q.overlayPlacements[v];if(w&&(w[0]<=u&&w[1]>=u&&w[2]<=C&&w[3]>=C)){return true}}var A=q.canvas.getContext("2d").getImageData(parseInt(u),parseInt(C),1,1);return A.data[0]!=0||A.data[1]!=0||A.data[2]!=0||A.data[3]!=0}return false};var p=false,o=false,t=null,s=false,r=function(v,u){return v!=null&&i(v,u)};this.mousemove=function(x){var z=n(x),w=f(x),v=document.elementFromPoint(w[0],w[1]),y=r(v,"_jsPlumb_overlay");var u=d==null&&(r(v,"_jsPlumb_endpoint")||r(v,"_jsPlumb_connector"));if(!p&&u&&q._over(x)){p=true;q.fire("mouseenter",q,x);return true}else{if(p&&(!q._over(x)||!u)&&!y){p=false;q.fire("mouseexit",q,x)}}q.fire("mousemove",q,x)};this.click=function(u){if(p&&q._over(u)&&!s){q.fire("click",q,u)}s=false};this.dblclick=function(u){if(p&&q._over(u)&&!s){q.fire("dblclick",q,u)}s=false};this.mousedown=function(u){if(q._over(u)&&!o){o=true;t=m(a(q.canvas));q.fire("mousedown",q,u)}};this.mouseup=function(u){o=false;q.fire("mouseup",q,u)};this.contextmenu=function(u){if(p&&q._over(u)&&!s){q.fire("contextmenu",q,u)}s=false}};var c=function(p){var o=document.createElement("canvas");p._jsPlumb.appendElement(o,p.parent);o.style.position="absolute";if(p["class"]){o.className=p["class"]}p._jsPlumb.getId(o,p.uuid);if(p.tooltip){o.setAttribute("title",p.tooltip)}return o};var l=function(p){k.apply(this,arguments);var o=[];this.getDisplayElements=function(){return o};this.appendDisplayElement=function(q){o.push(q)}};var h=jsPlumb.CanvasConnector=function(r){l.apply(this,arguments);var o=function(v,t){p.ctx.save();jsPlumb.extend(p.ctx,t);if(t.gradient){var u=p.createGradient(v,p.ctx);for(var s=0;s<t.gradient.stops.length;s++){u.addColorStop(t.gradient.stops[s][0],t.gradient.stops[s][1])}p.ctx.strokeStyle=u}p._paint(v,t);p.ctx.restore()};var p=this,q=p._jsPlumb.connectorClass+" "+(r.cssClass||"");p.canvas=c({"class":q,_jsPlumb:p._jsPlumb,parent:r.parent,tooltip:r.tooltip});p.ctx=p.canvas.getContext("2d");p.appendDisplayElement(p.canvas);p.paint=function(w,t){if(t!=null){jsPlumb.sizeCanvas(p.canvas,w[0],w[1],w[2],w[3]);if(p.getZIndex()){p.canvas.style.zIndex=p.getZIndex()}if(t.outlineColor!=null){var v=t.outlineWidth||1,s=t.lineWidth+(2*v),u={strokeStyle:t.outlineColor,lineWidth:s};o(w,u)}o(w,t)}}};var b=function(r){var p=this;l.apply(this,arguments);var q=p._jsPlumb.endpointClass+" "+(r.cssClass||""),o={"class":q,_jsPlumb:p._jsPlumb,parent:r.parent,tooltip:p.tooltip};p.canvas=c(o);p.ctx=p.canvas.getContext("2d");p.appendDisplayElement(p.canvas);this.paint=function(x,u,s){jsPlumb.sizeCanvas(p.canvas,x[0],x[1],x[2],x[3]);if(u.outlineColor!=null){var w=u.outlineWidth||1,t=u.lineWidth+(2*w);var v={strokeStyle:u.outlineColor,lineWidth:t}}p._paint.apply(this,arguments)}};jsPlumb.Endpoints.canvas.Dot=function(r){jsPlumb.Endpoints.Dot.apply(this,arguments);b.apply(this,arguments);var q=this,p=function(s){try{return parseInt(s)}catch(t){if(s.substring(s.length-1)=="%"){return parseInt(s.substring(0,s-1))}}},o=function(u){var s=q.defaultOffset,t=q.defaultInnerRadius;u.offset&&(s=p(u.offset));u.innerRadius&&(t=p(u.innerRadius));return[s,t]};this._paint=function(A,t,x){if(t!=null){var B=q.canvas.getContext("2d"),u=x.getOrientation(q);jsPlumb.extend(B,t);if(t.gradient){var v=o(t.gradient),y=u[1]==1?v[0]*-1:v[0],s=u[0]==1?v[0]*-1:v[0],z=B.createRadialGradient(A[4],A[4],A[4],A[4]+s,A[4]+y,v[1]);for(var w=0;w<t.gradient.stops.length;w++){z.addColorStop(t.gradient.stops[w][0],t.gradient.stops[w][1])}B.fillStyle=z}B.beginPath();B.arc(A[4],A[4],A[4],0,Math.PI*2,true);B.closePath();if(t.fillStyle||t.gradient){B.fill()}if(t.strokeStyle){B.stroke()}}}};jsPlumb.Endpoints.canvas.Rectangle=function(p){var o=this;jsPlumb.Endpoints.Rectangle.apply(this,arguments);b.apply(this,arguments);this._paint=function(x,r,v){var A=o.canvas.getContext("2d"),t=v.getOrientation(o);jsPlumb.extend(A,r);if(r.gradient){var z=t[1]==1?x[3]:t[1]==0?x[3]/2:0;var y=t[1]==-1?x[3]:t[1]==0?x[3]/2:0;var s=t[0]==1?x[2]:t[0]==0?x[2]/2:0;var q=t[0]==-1?x[2]:t[0]==0?x[2]/2:0;var w=A.createLinearGradient(s,z,q,y);for(var u=0;u<r.gradient.stops.length;u++){w.addColorStop(r.gradient.stops[u][0],r.gradient.stops[u][1])}A.fillStyle=w}A.beginPath();A.rect(0,0,x[2],x[3]);A.closePath();if(r.fillStyle||r.gradient){A.fill()}if(r.strokeStyle){A.stroke()}}};jsPlumb.Endpoints.canvas.Triangle=function(p){var o=this;jsPlumb.Endpoints.Triangle.apply(this,arguments);b.apply(this,arguments);this._paint=function(z,q,v){var s=z[2],C=z[3],B=z[0],A=z[1],D=o.canvas.getContext("2d"),w=0,u=0,t=0,r=v.getOrientation(o);if(r[0]==1){w=s;u=C;t=180}if(r[1]==-1){w=s;t=90}if(r[1]==1){u=C;t=-90}D.fillStyle=q.fillStyle;D.translate(w,u);D.rotate(t*Math.PI/180);D.beginPath();D.moveTo(0,0);D.lineTo(s/2,C/2);D.lineTo(0,C);D.closePath();if(q.fillStyle||q.gradient){D.fill()}if(q.strokeStyle){D.stroke()}}};jsPlumb.Endpoints.canvas.Image=jsPlumb.Endpoints.Image;jsPlumb.Endpoints.canvas.Blank=jsPlumb.Endpoints.Blank;jsPlumb.Connectors.canvas.Bezier=function(){var o=this;jsPlumb.Connectors.Bezier.apply(this,arguments);h.apply(this,arguments);this._paint=function(q,p){o.ctx.beginPath();o.ctx.moveTo(q[4],q[5]);o.ctx.bezierCurveTo(q[8],q[9],q[10],q[11],q[6],q[7]);o.ctx.stroke()};this.createGradient=function(r,p,q){return o.ctx.createLinearGradient(r[6],r[7],r[4],r[5])}};jsPlumb.Connectors.canvas.Straight=function(){var p=this,o=[null,[1,-1],[1,1],[-1,1],[-1,-1]];jsPlumb.Connectors.Straight.apply(this,arguments);h.apply(this,arguments);this._paint=function(r,t){p.ctx.beginPath();if(t.dashstyle&&t.dashstyle.split(" ").length==2){var v=t.dashstyle.split(" ");if(v.length!=2){v=[2,2]}var C=[v[0]*t.lineWidth,v[1]*t.lineWidth],y=(r[6]-r[4])/(r[7]-r[5]),G=jsPlumbUtil.segment([r[4],r[5]],[r[6],r[7]]),x=o[G],u=Math.atan(y),z=Math.sqrt(Math.pow(r[6]-r[4],2)+Math.pow(r[7]-r[5],2)),B=Math.floor(z/(C[0]+C[1])),w=[r[4],r[5]];for(var A=0;A<B;A++){p.ctx.moveTo(w[0],w[1]);var q=w[0]+(Math.abs(Math.sin(u)*C[0])*x[0]),F=w[1]+(Math.abs(Math.cos(u)*C[0])*x[1]),E=w[0]+(Math.abs(Math.sin(u)*(C[0]+C[1]))*x[0]),D=w[1]+(Math.abs(Math.cos(u)*(C[0]+C[1]))*x[1]);p.ctx.lineTo(q,F);w=[E,D]}p.ctx.moveTo(w[0],w[1]);p.ctx.lineTo(r[6],r[7])}else{p.ctx.moveTo(r[4],r[5]);p.ctx.lineTo(r[6],r[7])}p.ctx.stroke()};this.createGradient=function(r,q){return q.createLinearGradient(r[4],r[5],r[6],r[7])}};jsPlumb.Connectors.canvas.Flowchart=function(){var o=this;jsPlumb.Connectors.Flowchart.apply(this,arguments);h.apply(this,arguments);this._paint=function(r,q){o.ctx.beginPath();o.ctx.moveTo(r[4],r[5]);for(var p=0;p<r[8];p++){o.ctx.lineTo(r[9+(p*2)],r[10+(p*2)])}o.ctx.lineTo(r[6],r[7]);o.ctx.stroke()};this.createGradient=function(q,p){return p.createLinearGradient(q[4],q[5],q[6],q[7])}};jsPlumb.Overlays.canvas.Label=jsPlumb.Overlays.Label;jsPlumb.Overlays.canvas.Custom=jsPlumb.Overlays.Custom;var g=function(){jsPlumb.jsPlumbUIComponent.apply(this,arguments)};var e=function(p,o){p.apply(this,o);g.apply(this,o);this.paint=function(s,u,q,v,t){var r=s.ctx;r.lineWidth=q;r.beginPath();r.moveTo(u.hxy.x,u.hxy.y);r.lineTo(u.tail[0].x,u.tail[0].y);r.lineTo(u.cxy.x,u.cxy.y);r.lineTo(u.tail[1].x,u.tail[1].y);r.lineTo(u.hxy.x,u.hxy.y);r.closePath();if(v){r.strokeStyle=v;r.stroke()}if(t){r.fillStyle=t;r.fill()}}};jsPlumb.Overlays.canvas.Arrow=function(){e.apply(this,[jsPlumb.Overlays.Arrow,arguments])};jsPlumb.Overlays.canvas.PlainArrow=function(){e.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])};jsPlumb.Overlays.canvas.Diamond=function(){e.apply(this,[jsPlumb.Overlays.Diamond,arguments])}})();(function(a){jsPlumb.CurrentLibrary={addClass:function(c,b){c=jsPlumb.CurrentLibrary.getElementObject(c);try{if(c[0].className.constructor==SVGAnimatedString){jsPlumb.util.svg.addClass(c[0],b)}}catch(d){}c.addClass(b)},animate:function(d,c,b){d.animate(c,b)},appendElement:function(c,b){jsPlumb.CurrentLibrary.getElementObject(b).append(c)},ajax:function(b){b=b||{};b.type=b.type||"get";a.ajax(b)},bind:function(b,c,d){b=jsPlumb.CurrentLibrary.getElementObject(b);b.bind(c,d)},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete"},extend:function(c,b){return a.extend(c,b)},getAttribute:function(b,c){return b.attr(c)},getClientXY:function(b){return[b.clientX,b.clientY]},getDragObject:function(b){return b[1].draggable},getDragScope:function(b){return b.draggable("option","scope")},getDropEvent:function(b){return b[0]},getDropScope:function(b){return b.droppable("option","scope")},getDOMElement:function(b){if(typeof(b)=="string"){return document.getElementById(b)}else{if(b.context||b.length!=null){return b[0]}else{return b}}},getElementObject:function(b){return typeof(b)=="string"?a("#"+b):a(b)},getOffset:function(b){return b.offset()},getOriginalEvent:function(b){return b.originalEvent},getPageXY:function(b){return[b.pageX,b.pageY]},getParent:function(b){return jsPlumb.CurrentLibrary.getElementObject(b).parent()},getScrollLeft:function(b){return b.scrollLeft()},getScrollTop:function(b){return b.scrollTop()},getSelector:function(b){return a(b)},getSize:function(b){return[b.outerWidth(),b.outerHeight()]},getTagName:function(b){var c=jsPlumb.CurrentLibrary.getElementObject(b);return c.length>0?c[0].tagName:null},getUIPosition:function(c){if(c.length==1){ret={left:c[0].pageX,top:c[0].pageY}}else{var d=c[1],b=d.offset;ret=b||d.absolutePosition}return ret},hasClass:function(c,b){return c.hasClass(b)},initDraggable:function(c,b,d){b=b||{};b.helper=null;if(d){b.scope=b.scope||jsPlumb.Defaults.Scope}c.draggable(b)},initDroppable:function(c,b){b.scope=b.scope||jsPlumb.Defaults.Scope;c.droppable(b)},isAlreadyDraggable:function(b){b=jsPlumb.CurrentLibrary.getElementObject(b);return b.hasClass("ui-draggable")},isDragSupported:function(c,b){return c.draggable},isDropSupported:function(c,b){return c.droppable},removeClass:function(c,b){c=jsPlumb.CurrentLibrary.getElementObject(c);try{if(c[0].className.constructor==SVGAnimatedString){jsPlumb.util.svg.removeClass(c[0],b)}}catch(d){}c.removeClass(b)},removeElement:function(b,c){jsPlumb.CurrentLibrary.getElementObject(b).remove()},setAttribute:function(c,d,b){c.attr(d,b)},setDraggable:function(c,b){c.draggable("option","disabled",!b)},setDragScope:function(c,b){c.draggable("option","scope",b)},setOffset:function(b,c){jsPlumb.CurrentLibrary.getElementObject(b).offset(c)},trigger:function(d,e,b){var c=jQuery._data(jsPlumb.CurrentLibrary.getElementObject(d)[0],"handle");c(b)},unbind:function(b,c,d){b=jsPlumb.CurrentLibrary.getElementObject(b);b.unbind(c,d)}};a(document).ready(jsPlumb.init)})(jQuery);(function(){"undefined"==typeof Math.sgn&&(Math.sgn=function(l){return 0==l?0:0<l?1:-1});var d={subtract:function(m,l){return{x:m.x-l.x,y:m.y-l.y}},dotProduct:function(m,l){return m.x*l.x+m.y*l.y},square:function(l){return Math.sqrt(l.x*l.x+l.y*l.y)},scale:function(m,l){return{x:m.x*l,y:m.y*l}}},f=Math.pow(2,-65),h=function(y,x){for(var t=[],v=x.length-1,r=2*v-1,s=[],w=[],p=[],q=[],o=[[1,0.6,0.3,0.1],[0.4,0.6,0.6,0.4],[0.1,0.3,0.6,1]],u=0;u<=v;u++){s[u]=d.subtract(x[u],y)}for(u=0;u<=v-1;u++){w[u]=d.subtract(x[u+1],x[u]);w[u]=d.scale(w[u],3)}for(u=0;u<=v-1;u++){for(var m=0;m<=v;m++){p[u]||(p[u]=[]);p[u][m]=d.dotProduct(w[u],s[m])}}for(u=0;u<=r;u++){q[u]||(q[u]=[]);q[u].y=0;q[u].x=parseFloat(u)/r}r=v-1;for(s=0;s<=v+r;s++){u=Math.max(0,s-r);for(w=Math.min(s,v);u<=w;u++){j=s-u;q[u+j].y=q[u+j].y+p[j][u]*o[j][u]}}v=x.length-1;q=a(q,2*v-1,t,0);r=d.subtract(y,x[0]);p=d.square(r);for(u=o=0;u<q;u++){r=d.subtract(y,k(x,v,t[u],null,null));r=d.square(r);if(r<p){p=r;o=t[u]}}r=d.subtract(y,x[v]);r=d.square(r);if(r<p){p=r;o=1}return{location:o,distance:p}},a=function(C,B,x,z){var v=[],w=[],A=[],t=[],u=0,s,y;y=Math.sgn(C[0].y);for(var q=1;q<=B;q++){s=Math.sgn(C[q].y);s!=y&&u++;y=s}switch(u){case 0:return 0;case 1:if(z>=64){x[0]=(C[0].x+C[B].x)/2;return 1}var p,u=C[0].y-C[B].y;y=C[B].x-C[0].x;q=C[0].x*C[B].y-C[B].x*C[0].y;s=max_distance_below=0;for(p=1;p<B;p++){var r=u*C[p].x+y*C[p].y+q;r>s?s=r:r<max_distance_below&&(max_distance_below=r)}p=y;s=(1*(q-s)-p*0)*(1/(0*p-u*1));p=y;y=q-max_distance_below;u=(1*y-p*0)*(1/(0*p-u*1));y=Math.min(s,u);if(Math.max(s,u)-y<f){A=C[B].x-C[0].x;t=C[B].y-C[0].y;x[0]=0+1*(A*(C[0].y-0)-t*(C[0].x-0))*(1/(A*0-t*1));return 1}}k(C,B,0.5,v,w);C=a(v,B,A,z+1);B=a(w,B,t,z+1);for(z=0;z<C;z++){x[z]=A[z]}for(z=0;z<B;z++){x[z+C]=t[z]}return C+B},k=function(m,l,p,q,n){for(var o=[[]],r=0;r<=l;r++){o[0][r]=m[r]}for(m=1;m<=l;m++){for(r=0;r<=l-m;r++){o[m]||(o[m]=[]);o[m][r]||(o[m][r]={});o[m][r].x=(1-p)*o[m-1][r].x+p*o[m-1][r+1].x;o[m][r].y=(1-p)*o[m-1][r].y+p*o[m-1][r+1].y}}if(q!=null){for(r=0;r<=l;r++){q[r]=o[r][0]}}if(n!=null){for(r=0;r<=l;r++){n[r]=o[l-r][r]}}return o[l][0]},g={},e=function(t){var s=g[t];if(!s){var s=[],p=function(u){return function(){return u}},q=function(){return function(u){return u}},n=function(){return function(u){return 1-u}},o=function(u){return function(v){for(var x=1,w=0;w<u.length;w++){x=x*u[w](v)}return x}};s.push(new function(){return function(u){return Math.pow(u,t)}});for(var r=1;r<t;r++){for(var l=[new p(t)],m=0;m<t-r;m++){l.push(new q)}for(m=0;m<r;m++){l.push(new n)}s.push(new o(l))}s.push(new function(){return function(u){return Math.pow(1-u,t)}});g[t]=s}return s},c=function(m,l){for(var p=e(m.length-1),q=0,n=0,o=0;o<m.length;o++){q=q+m[o].x*p[o](l);n=n+m[o].y*p[o](l)}return{x:q,y:n}},b=function(m,l,p){for(var q=c(m,l),n=0,o=p>0?1:-1,r=null;n<Math.abs(p);){l=l+0.005*o;r=c(m,l);n=n+Math.sqrt(Math.pow(r.x-q.x,2)+Math.pow(r.y-q.y,2));q=r}return{point:r,location:l}},i=function(m,l){var o=c(m,l),p=c(m.slice(0,m.length-1),l),n=p.y-o.y,o=p.x-o.x;return n==0?Infinity:Math.atan(n/o)};window.jsBezier={distanceFromCurve:h,gradientAtPoint:i,gradientAtPointAlongCurveFrom:function(m,l,n){l=b(m,l,n);if(l.location>1){l.location=1}if(l.location<0){l.location=0}return i(m,l.location)},nearestPointOnCurve:function(m,l){var n=h(m,l);return{point:k(l,l.length-1,n.location,null,null),location:n.location}},pointOnCurve:c,pointAlongCurveFrom:function(m,l,n){return b(m,l,n).point},perpendicularToCurveAt:function(m,l,n,o){l=b(m,l,o==null?0:o);m=i(m,l.location);o=Math.atan(-1/m);m=n/2*Math.sin(o);n=n/2*Math.cos(o);return[{x:l.point.x+n,y:l.point.y+m},{x:l.point.x-n,y:l.point.y-m}]},locationAlongCurveFrom:function(m,l,n){return b(m,l,n).location}}})();